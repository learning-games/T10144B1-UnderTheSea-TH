<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‡πÄ‡∏Å‡∏°-‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡πÉ‡∏ï‡πâ‡∏ó‡πâ‡∏≠‡∏á‡∏ó‡∏∞‡πÄ‡∏•(‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏≥) ‡∏õ.1-3</title>
<style>
/* ===== ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏£‡∏ß‡∏°‡∏´‡∏ô‡πâ‡∏≤ (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== */
@font-face{
  font-family: 'MyGameFont';
  src: url('image/THSarabunNew.woff2') format('woff2'),
       url('image/THSarabunNew.woff') format('woff'),
       url('image/THSarabunNew.ttf') format('truetype');
  font-weight: 400; font-style: normal; font-display: swap;
}
@font-face{
  font-family: 'MyGameFont';
  src: url('image/THSarabunNewBold.woff2') format('woff2'),
       url('image/THSarabunNewBold.woff') format('woff'),
       url('image/THSarabunNewBold.ttf') format('truetype');
  font-weight: 700; font-style: normal; font-display: swap;
}
html, body, button, input, select, textarea, .pill, .btn, .btn-mini,
.levelBtn, #startTitle, #countdown, .label, #timer {
  font-family: 'MyGameFont', system-ui, -apple-system, 'Segoe UI', Arial, sans-serif;
}

:root{
  --glass: rgba(0,0,0,.45);
  --ok: #10b981;
  --bad: #ef4444;
  --hud-top: 15px;
  --safe-top: env(safe-area-inset-top, 0px);
}

*{ box-sizing:border-box }
html,body{ height:100%; margin:0 }
body{
  background: url("image/background2.png") center center / cover no-repeat fixed !important;
  overflow:hidden; color:#fff;
}
#game{ position:relative; width:100vw; height:100vh; overflow:hidden }

/* ===== HUD (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== */
.hud{
  position:fixed;
  inset: calc(var(--safe-top) + var(--hud-top)) 5px auto 38px !important;
  display:flex;
  align-items:center;
  gap:12px;
  justify-content:space-between;
  pointer-events:none;
  z-index:40000;
}
/* ‡∏ã‡πà‡∏≠‡∏ô HUD ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà in-game */
body:not(.in-game):not(.prestart) .hud { display:none !important; }
/* ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ ‡πÇ‡∏ú‡∏•‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô in-game */
body:not(.in-game) #clock { display:none !important; }

/* ===== Game Clock (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== */
#clock.clock-pill{
  position:fixed; top:14px; left:50%; transform:translateX(-50%);
  z-index:16000; pointer-events:none;
  --clock-size: 40px; font-size: var(--clock-size);
  background: var(--glass); backdrop-filter: blur(6px);
  color:#fff; font-weight:1000; line-height:1; border-radius:999px;
  padding:8px 16px; box-shadow:0 4px 18px rgba(0,0,0,.25);
  text-shadow:0 3px 10px rgba(0,0,0,.55);
}
@media (max-width:480px){
  #clock.clock-pill{ --clock-size: 28px; padding:6px 12px; }
}

.pill{ background:var(--glass); backdrop-filter:blur(6px); padding:8px 12px; border-radius:999px; box-shadow:0 4px 18px rgba(0,0,0,.25) }
#timer{ font-weight:700; font-variant-numeric:tabular-nums; letter-spacing:.5px; font-size:20px }
.btn-mini{ pointer-events:auto; background:#1f2937; color:#fff; border:none; border-radius:12px; padding:8px 12px; font-weight:800; cursor:pointer; box-shadow:0 4px 18px rgba(0,0,0,.25) }
.btn-mini:hover{ filter:brightness(1.1) }

/* ===== ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç + ‡∏´‡∏•‡∏≠‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ===== */
.pill.gold{
  background: var(--glass);
  border-radius: 999px;
  padding: 8px 16px;              /* ‡πÄ‡∏î‡∏¥‡∏° 6px 10px ‚Üí ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: flex-end;      /* ‡∏ä‡∏¥‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á pill */
  flex-direction: row-reverse;    /* üîπ ‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: ‡πÄ‡∏•‡∏Ç‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤ ‡∏´‡∏•‡∏≠‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ã‡πâ‡∏≤‡∏¢ */
  gap: 10px;                      /* ‡πÄ‡∏î‡∏¥‡∏° 8px ‚Üí ‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
  width: auto;
  max-width: none;
  white-space: nowrap;
  overflow: visible;
  box-shadow: 0 4px 18px rgba(0,0,0,.25);
}

/* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô */
.pill.gold .score-num{
  font-size: 24px;         /* ‡πÄ‡∏î‡∏¥‡∏° 20px ‚Üí ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
  font-weight: 900;
  letter-spacing: .5px;
  text-align: center;      /* ‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ä‡∏¥‡∏î‡∏Ç‡∏ß‡∏≤‡πÉ‡∏ô‡∏´‡∏•‡∏≠‡∏î */
  min-width: 48px;         /* ‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏Ç‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏•‡∏±‡∏Å */
}

/* ‡∏´‡∏•‡∏≠‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô */
.pill.gold .score-bar{
  position: relative;
  width: 220px;                 /* ‡πÄ‡∏î‡∏¥‡∏° 140px ‚Üí ‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô */
  height: 16px;                 /* ‡πÄ‡∏î‡∏¥‡∏° 10px ‚Üí ‡∏´‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô */
  border-radius: 999px;
  background: rgba(255,255,255,.18);
  overflow: hidden;
}

/* ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏µ (fill) ‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô */
.pill.gold .score-bar-fill{
  position: absolute;
  inset: 0;
  transform-origin: left center;
  transform: scaleX(0);
  background: linear-gradient(90deg,#3b82f6,#22d3ee); /* ‡πÄ‡∏î‡∏¥‡∏°‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‚Üí ‡∏ü‡πâ‡∏≤‡πÄ‡∏Å‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ô */
  transition: transform .25s ease-out;
}

/* ‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏≠‡∏î‡∏™‡∏±‡πâ‡∏ô‡∏•‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
@media (max-width:480px){
  .pill.gold .score-bar{
    width: 160px;   /* ‡πÄ‡∏î‡∏¥‡∏° 110px ‚Üí ‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏à‡∏≠‡πÉ‡∏´‡∏ç‡πà */
  }
}


/* ===== Welcome / Landing (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡∏õ‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏î‡πà‡∏≤‡∏ô) ===== */
#landing{ position:fixed; inset:0; display:flex; flex-direction:column; gap:22px; align-items:center; justify-content:center; background:url("image/background2.png") center/cover no-repeat fixed !important; z-index:20000; transition:opacity .3s ease }
#landing.hide{ opacity:0; pointer-events:none; visibility:hidden }
#landing .brand{ width:min(92vw,1100px) }
#landing .brand img{ width:100%; height:auto; display:block; filter:drop-shadow(0 10px 30px rgba(0,0,0,.6)) }
#welcome{ position:fixed; inset:0; background:url("image/welcome.png") center/cover no-repeat fixed; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:24px; z-index:25000; transition:opacity .3s ease; }
#welcome.hide{ opacity:0; pointer-events:none; visibility:hidden }
#welcome #enterBtn{ padding:12px 28px; font-size:clamp(22px,4vw,36px); font-weight:1000; letter-spacing:.2px; border:0; border-radius:16px; color:#fff; background:rgba(0,0,0,.55); box-shadow:0 10px 28px rgba(0,0,0,.35); cursor:pointer; backdrop-filter:blur(6px); border:1px solid rgba(255,255,255,.18) }
#welcome .brand{ width:min(90vw,1000px); margin-bottom:100px; display:flex; justify-content:center }
#welcome .brand img{ width:130%; height:auto; display:block; animation:pulse 3s infinite ease-in-out; filter:drop-shadow(0 6px 18px rgba(0,0,0,.45)) }
#welcome .welcome-content{ display:flex; flex-direction:column; align-items:center; gap:0; margin-top:100px }
@keyframes pulse{ 0%,100%{transform:scale(1);opacity:1} 50%{transform:scale(1.04);opacity:.9} }
.level-menu{ display:flex; flex-direction:column; gap:14px; width:min(92vw,640px) }
.levelBtn{ width:100%; padding:10px 16px; font-size:clamp(20px,4vw,34px); font-weight:1000; letter-spacing:.2px; border:0; border-radius:14px; color:#fff; background:rgba(0,0,0,.55); box-shadow:0 10px 28px rgba(0,0,0,.35); cursor:pointer; text-align:center; border:1px solid rgba(255,255,255,.18); backdrop-filter:blur(6px) }

/* ===== ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°/‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à) ===== */
#startScreen{
  position:fixed; inset:0; display:none; flex-direction:column; align-items:center; justify-content:center;
  background:rgba(0,0,0,.9); z-index:30000; text-align:center; padding:24px;
}
#startTitle{ font-size:clamp(26px,5vw,48px); font-weight:900; margin-bottom:10px }
#startBtn{ margin-top:12px; padding:10px 18px; border:0; border-radius:12px; font-weight:800; cursor:pointer; background:#1f2937; color:#fff }
#countdown{ display:none; font-size:clamp(56px,12vw,120px); font-weight:1000; line-height:1; margin-top:8px }

/* ===== ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡∏•‡∏≠‡∏¢‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ===== */
#qImg{ display:none }

#questionBox{
  position:fixed;
  left:0;
  top:0;
  /* ‡∏Å‡∏•‡πà‡∏≠‡∏á hitbox ‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏õ‡∏•‡∏≤ */
  translate: var(--qx, 50vw) var(--qy, 50vh);
  transform: translate(-50%, -50%) scale(1);
  width: clamp(80px, 10vw, 130px);
  height: clamp(80px, 10vw, 130px);
  background:none;
  border-radius:999px;
  z-index: 12000;
  pointer-events:auto;   /* ‡∏¢‡∏±‡∏á‡∏•‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° */
  opacity: 1;
  will-change: translate, scale, opacity;
  /* ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏ô‡πÉ‡∏à font/text ‡πÅ‡∏•‡πâ‡∏ß */
  font-size:0;
}


/* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô hitbox ‡πÄ‡∏â‡∏¢ ‡πÜ ) */
#questionBox::before{
  content:none;
}
#questionBox:empty::before{
  display:none;
}


/* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (‡πÅ‡∏™‡∏î‡∏á‡∏ã‡πâ‡∏≥‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏Ç‡∏¢‡∏±‡∏ö ‡πÑ‡∏°‡πà‡∏Ñ‡∏•‡∏¥‡∏Å) */
#questionBoxTop{
  position:fixed;
  left:50%;
  top:100px;                    /* ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÉ‡∏ï‡πâ clock ‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
  transform:translateX(-50%);
  background:none;
  font-size: clamp(20px, 4vw, 56px); /* üîπ ‡∏•‡∏î‡∏à‡∏≤‡∏Å 28/6vw/90px ‚Üí 20/4vw/56px */
  font-weight:1000;
  color:#fff;
  text-shadow:0 4px 12px rgba(0,0,0,.8);
  z-index: 11900;              /* ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ questionBox ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏ä‡∏ô‡∏ü‡∏≠‡∏á */
  white-space:pre;
  pointer-events:none;         /* ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏ä‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ */
  opacity:1;
}

/* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å */
#questionBoxTop::before{
  content:"";
  position:absolute;
  inset: -12px -28px;
  z-index:-1;
  border-radius:24px;
  background: var(--qbox-bg, linear-gradient(135deg, #ff8a00, #e52e71));
  box-shadow:0 6px 20px rgba(0,0,0,.25);
}
#questionBoxTop:empty::before{
  display:none;
}


/* ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô) */
:root{
  --emo-x: 0px;
  --emo-y: -150px;
  --emo-scale: 1;
}
#qEmoji{
  display:none;   /* ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß */
}

/* ‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤ ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°+‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥ */
#questionSprite{
  position:fixed;
  left:0;
  top:0;
  translate: var(--qx, 50vw) var(--qy, 50vh);
  transform: translate(-50%, -50%) scale(1);
  width: clamp(140px, 18vw, 240px);
  height:auto;
  user-select:none;
  pointer-events:auto;   /* ‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å/‡∏•‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡∏õ‡∏•‡∏≤‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á */
  z-index: 12010;        /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ questionBox ‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á */
}

/* ===== Alert ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß/‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô‡∏õ‡∏•‡∏≤ ===== */
#zoneAlert{
  position:fixed;
  left:50%;
  top:50%;
  transform: translate(-50%, -50%) scale(1);
  width: clamp(240px, 36vw, 440px);
  height:auto;
  opacity:0;
  pointer-events:none;
  z-index:13000;
  animation: alertPulse .7s ease-in-out infinite;
  transition: opacity .15s ease;

  /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô */
  display:block;
}

/* ‡∏ï‡∏±‡∏ß‡∏£‡∏π‡∏õ‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏£‡∏≠‡∏ö */
#zoneAlert img{
  width:100%;
  height:auto;
  display:block;
}

/* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‚Äú‡∏¢‡∏∑‡∏ô‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ô‡∏µ‡πâ‚Äù ‡∏ó‡∏±‡∏ö‡∏ö‡∏ô‡∏£‡∏π‡∏õ */
.zone-alert-label{
  position:absolute;
  left:50%;
  top:50%;  /* ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 60% ‡πÑ‡∏î‡πâ */
  transform: translate(-50%, -50%);
  font-size: clamp(18px, 2.4vw, 28px);
  font-weight: 900;
  color:#fff;
  text-shadow: 0 3px 8px rgba(0,0,0,.85);  /* ‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô‡∏ö‡∏ô‡∏£‡∏π‡∏õ */
  text-align:center;
}


/* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Ç‡∏¢‡∏≤‡∏¢‚Äì‡∏´‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á */
@keyframes alertPulse{
  0%{
    transform: translate(-50%, -50%) scale(1);
  }
  50%{
    transform: translate(-50%, -50%) scale(1.18);
  }
  100%{
    transform: translate(-50%, -50%) scale(1);
  }
}


/* üîπ ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡πÑ‡∏ß‡πâ‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà in-game */
body:not(.in-game) #questionSprite{
  display:none;
}



/* ----- ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏•‡∏≠‡∏¢ ----- */
.fly-score{
  position:fixed;
  left:0;
  top:0;
  font-weight:1000;
   font-size: clamp(40px, 6vw, 80px);
  pointer-events:none;
  z-index:20000;
  opacity:0;
  transform:translate(-50%, 10px) scale(.96);
  animation:flyUp 900ms ease-out forwards;
  text-shadow:0 6px 20px rgba(0,0,0,.55);
}
.fly-score.ok{ color:#10b981 }
.fly-score.bad{ color:#ef4444 }
@keyframes flyUp{
  0%{opacity:0; transform:translate(-50%, 10px) scale(.96);}
  15%{opacity:1; transform:translate(-50%, 0) scale(1);}
  100%{opacity:0; transform:translate(-50%, -60px) scale(1.06);}
}

/* ===== ‡∏Å‡∏•‡πâ‡∏≠‡∏á/‡πÅ‡∏Ñ‡∏ô‡∏ß‡∏≤‡∏™ AR (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== */
#cameraMirror{
  position:fixed;
  inset:0;
  width:100vw;
  height:100vh;
  object-fit:cover;
  transform: scaleX(-1);
  z-index:1;
  display:none;
  background:#000
}

#camCanvas{
  position:fixed;
  inset:0;
  width:100vw;
  height:100vh;
  z-index:2;
  pointer-events:none;
  display:none
}

/* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á, ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏∞‡∏•‡∏∏, ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏°) */
#cameraBg{
  position:fixed;
  inset:0;
  width:100vw;
  height:100vh;
  object-fit:cover;
  z-index:3;          /* ‚Üê ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÅ‡∏´‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏õ‡∏±‡∏ç‡∏´‡∏≤ */
  pointer-events:none;
  display:none;         /* ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á */
}



/* ‡∏õ‡∏∏‡πà‡∏° Mute / Fullscreen (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) */
#muteBtn, #fsBtn{
  position: fixed; right: 12px; width: 44px; height: 44px; border-radius: 999px; background: rgba(0,0,0,.45);
  border: 1px solid rgba(255,255,255,.3); color: #fff; font-size: 18px; line-height: 1; display: grid; place-items: center; cursor: pointer; z-index: 50000;
}
#muteBtn{ bottom:12px } #fsBtn{ bottom:62px }

/* ===== ‡∏°‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== */
body::after{ content:""; position:fixed; top:0; left:0; width:var(--corner-img-w, 220px); height:var(--corner-img-h, 220px); background:url("image/button1.png") no-repeat left top / contain; pointer-events:none; z-index:10000 }
body::before{ content:""; position:fixed; top:0; right:0; width:var(--corner2-img-w, 200px); height:var(--corner2-img-h, 200px); background:url("image/button2.png") no-repeat right top / contain; pointer-events:none; z-index:10000 }

/* ===== ‡∏£‡∏π‡∏õ‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏° (plus1/plus2) ===== */
:root{
  --plus1-left: -40px;
  --plus1-bottom: -40px;
  --plus1-w: 300px;
  --plus2-right: -40px;
  --plus2-bottom: -40px;
  --plus2-w: 300px;
  --plus-z: 45000;
}
.plus-deco{
  position: fixed;
  bottom: 0;
  width: auto;
  height: auto;
  pointer-events: none;
  user-select: none;
  z-index: var(--plus-z);
  display: none;
}
body.in-game .plus-deco{ display:block; }
#plus1Deco{
  left: var(--plus1-left);
  bottom: var(--plus1-bottom);
  width: var(--plus1-w);
}
#plus2Deco{
  right: var(--plus2-right);
  bottom: var(--plus2-bottom);
  width: var(--plus2-w);
}

/* ===== HUD ‡∏ï‡∏£‡∏∂‡∏á‡∏ã‡πâ‡∏≤‡∏¢/‡∏Ç‡∏ß‡∏≤ (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== */
.hud { position: initial !important; inset: auto !important; }
.hud .left, .hud .right {
  position: fixed !important; top: var(--hud-top) !important;
  z-index: 40000 !important; pointer-events: none;
}
.hud .left { left: 20px !important; }
.hud .right { right: 20px !important; }
.hud .btn-mini { pointer-events:auto; }

#goldWrap:empty{
  display:none;
}

/* ===== Result Panel (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== */
.result-panel{
  --panel-bg: rgba(20,20,20,.92);
  --panel-br: 20px;
  --panel-bd: 1px solid rgba(255,255,255,.12);
  --shadow: 0 20px 60px rgba(0,0,0,.55);
  background: var(--panel-bg);
  border: var(--panel-bd);
  padding: clamp(20px, 4vw, 32px);
  border-radius: var(--panel-br);
  width: min(92vw, 640px);
  display: grid; grid-template-rows: auto auto auto auto;
  gap: clamp(12px, 2vw, 18px); text-align: center; box-shadow: var(--shadow); backdrop-filter: blur(6px);
}
.result-title{ margin:0; font-weight:1000; font-size:clamp(28px,4.5vw,44px); letter-spacing:.2px; text-shadow:0 4px 14px rgba(0,0,0,.35) }
.badge{ font-size:clamp(56px,10vw,120px); line-height:1; filter: drop-shadow(0 8px 24px rgba(0,0,0,.45)); margin:6px 0 4px }

.result-metrics{ display:grid; grid-template-columns:1fr; gap:clamp(10px,2vw,16px); margin-top:4px }
.metric{ background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:clamp(10px,2vw,16px); box-shadow:0 8px 26px rgba(0,0,0,.25) inset, 0 8px 24px rgba(0,0,0,.25) }
.metric .label{ font-size:clamp(14px,2.2vw,18px); opacity:.9; margin-bottom:4px }
.metric .value{ font-size:clamp(28px,5.5vw,52px); font-weight:1000; line-height:1; letter-spacing:.3px }
.result-actions{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:6px }
.btn{ appearance:none; border:none; border-radius:14px; padding:clamp(10px,2.2vw,14px) clamp(16px,3.5vw,24px); font-weight:900; font-size:clamp(16px,2.8vw,20px); cursor:pointer; box-shadow:0 10px 28px rgba(0,0,0,.35); transition: transform .08s ease, filter .15s ease, box-shadow .15s ease; }
.btn:active{ transform: translateY(1px) scale(.99); }
.btn.strong{ color:#fff; background:linear-gradient(180deg,#3b82f6,#1d4ed8); border:1px solid rgba(255,255,255,.15) }
.btn.strong:hover{ filter:brightness(1.08) }
.btn.ghost{ color:#fff; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18) }
.btn.ghost:hover{ filter:brightness(1.1) }

/* ===== ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ß‡∏•‡∏≤/‡πÅ‡∏ü‡∏•‡∏ä/‡πÇ‡∏ó‡∏™‡∏ï‡πå/‡∏£‡∏π‡∏õ‡∏ú‡∏• (‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏ï‡πà‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ) ===== */
#timebarWrap{ position:fixed; left:0; right:0; bottom:0; height:12px; background:rgba(255,255,255,.12); z-index:16000; border-top:1px solid rgba(255,255,255,.2); display:none !important }
#flash{ position:fixed; inset:0; background:transparent; pointer-events:none; z-index:17000 }
#roundToast{ position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,.78); border:1px solid rgba(255,255,255,.22); padding:18px 26px; border-radius:16px; font-size:clamp(22px,3vw,34px); font-weight:900; z-index:17500; display:none; text-align:center; white-space:nowrap; line-height:1.25; }
#ansImg{ position:fixed; inset:0; width:100vw; height:100vh; object-fit:cover; object-position:center; opacity:.95; filter: drop-shadow(0 20px 60px rgba(0,0,0,.50)); z-index:17499; display:none; pointer-events:none; }

/* ===== ‚Äú‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå‡∏ü‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‚Äù (‡πÉ‡∏´‡∏°‡πà) ===== */
#bubbleLayer{
  position:absolute;
  inset:0;
  pointer-events:none;   /* ‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡∏•‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° pointer ‡πÄ‡∏≠‡∏á */
  z-index:11500;
  overflow:visible;
}

.bubble{
  position:absolute;
  pointer-events:auto;

  width: clamp(130px, 16vw, 200px);
  height: clamp(130px, 16vw, 200px);
  padding: 0;

  display:flex;
  flex-direction:column;      /* ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô + ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
  align-items:center;
  justify-content:center;


  border-radius:50%;
  font-size:clamp(26px, 3.2vw, 40px);
  font-weight:900;
  text-align:center;
  white-space:normal;
  line-height:1.25;
  user-select:none;

  color: #fff;

  /* ‚úî ‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏¢‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
  background:
    radial-gradient(circle at 30% 20%, rgba(255,255,255,.22), transparent 60%),
    radial-gradient(circle at 70% 80%, rgba(0,0,0,.28), transparent 65%),
    rgba(0,0,0,.35);

  /* ‚úî ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° */
  border: 1px solid rgba(255,255,255,.3);

  /* ‚úî ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡πÅ‡∏ö‡∏ö‡∏õ‡∏∏‡πà‡∏° */
  backdrop-filter: blur(4px);        /* ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì blur(6px) ‡∏ü‡∏≠‡∏á‡πÄ‡∏ö‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏¥‡∏î */

  /* ‚úî ‡πÄ‡∏á‡∏≤‡∏ô‡∏∏‡πà‡∏° ‡πÜ ‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡∏ß */
  box-shadow: 0 10px 26px rgba(0,0,0,.45);

   text-shadow: 0 2px 6px rgba(0,0,0,.55);

  transform:translate(100vw, 50vh);
}

/* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏¢‡∏Å emoji / ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏ü‡∏≠‡∏á */
.bubble-emoji{
  font-size:1.3em;      /* ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
  line-height:1;
  margin-bottom:12px;   /* ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥ ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
}

.bubble-text{
  font-size:1.1em;       /* ‚úÖ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏ô‡∏ü‡∏≠‡∏á */
  line-height:1.3;
  padding:0 6px;
  white-space: nowrap;   /* ‚¨Ö ‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
  overflow: visible;     /* ‚¨Ö ‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡∏ü‡∏≠‡∏á‡πÑ‡∏î‡πâ */
}

/* hover ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏ö‡∏ô desktop */
@media (hover:hover){


  .bubble:hover{
    transform:translate(var(--bx, 100vw), var(--by, 50vh)) scale(1.04);
  }
}

</style>
</head>
<body>

<!-- ==== AR Mirror (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ==== -->
<video id="cameraMirror" playsinline muted></video>
<canvas id="camCanvas"></canvas>
<img id="cameraBg" src="image/camerabackground.png" alt="" />

<div id="game" aria-label="‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏Å‡∏°">
  <div id="questionBoxTop" aria-hidden="true"></div>
  <div id="questionBox" aria-live="polite"></div>
  <!-- ‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤ ‡∏ó‡∏µ‡πà‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß / ‡∏•‡∏≤‡∏Å‡πÑ‡∏î‡πâ (hitbox ‡∏Ñ‡∏∑‡∏≠ questionBox) -->
  <img id="questionSprite" src="image/fish1.png" alt="" aria-hidden="true">
  <img id="qImg" alt="‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°" />
  <!-- ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏ó‡∏µ‡πà‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡∏ã‡πà‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢ CSS ‡πÅ‡∏•‡πâ‡∏ß) -->
  <div id="qEmoji" aria-hidden="true">üì¶</div>

  <!-- ‡∏£‡∏π‡∏õ Alert ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô 40% (‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á) -->
  <div id="zoneAlert" aria-hidden="true">
    <img src="image/alert.png" alt="">
    <div class="zone-alert-label">‡∏¢‡∏∑‡∏ô‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ô‡∏µ‡πâ</div>
  </div>



  <!-- ‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå‡∏ü‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö -->
  <div id="bubbleLayer" aria-hidden="false"></div>
</div>


<!-- ‡πÇ‡∏ã‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏î‡∏¥‡∏° (‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï) -->
<div id="zones" aria-hidden="true" style="display:none;">
  <div class="zone left">
    <div id="btnTrueBlend" class="ansbtn hidden" role="button">‡∏ã‡πâ‡∏≤‡∏¢</div>
  </div>
  <div class="zone mid"></div>
  <div class="zone right">
    <div id="btnFalseBlend" class="ansbtn hidden" role="button">‡∏Ç‡∏ß‡∏≤</div>
  </div>
</div>

<!-- ===== ‡∏£‡∏π‡∏õ‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏° (‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ/‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏∞‡∏•‡∏∏) ===== -->
<img id="plus1Deco" class="plus-deco" src="image/plus1.png" alt="">
<img id="plus2Deco" class="plus-deco" src="image/plus2.png" alt="">

<!-- ===== Welcome ===== -->
<div id="welcome" role="dialog" aria-modal="true">
  <div class="welcome-content">
    <div class="brand"><img src="image/banner2.png" alt="Banner"></div>
    <button id="enterBtn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏°</button>
  </div>
</div>

<!-- ===== Landing (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô) ===== -->
<div id="landing" role="dialog" aria-modal="true" class="hide">
  <div class="brand"><img src="image/banner2.png" alt="Banner"></div>
  <div class="level-menu">
    <button class="levelBtn" data-level="1">‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏≥(‡∏´ ‡∏ô‡∏≥)</button>
    <button class="levelBtn" data-level="2">‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏π‡∏á/‡∏Å‡∏•‡∏≤‡∏á‡∏ô‡∏≥</button>
    <button class="levelBtn" data-level="3">‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏≥</button>
    <button class="levelBtn" id="guideBtn">‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô üìñ</button>
  </div>
</div>

<!-- ===== ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° ===== -->
<div id="startScreen">
  <div id="startTitle">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à : ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</div>
  <button id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°</button>
  <div id="countdown">3</div>
</div>

<!-- ===== ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== -->
<div id="guideScreen" style="display:none; position:fixed; inset:0; align-items:center; justify-content:center; background:url('image/background2.png') center/cover no-repeat; z-index:20001">
  <div class="guide-wrap" style="width:min(95vw, 1200px); max-height:92vh; display:flex; flex-direction:column; gap:10px; align-items:center; justify-content:center">
    <img src="image/guide.png" alt="‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÄ‡∏Å‡∏°" style="width:100%; height:auto; max-height:92vh; border-radius:14px; box-shadow:0 20px 60px rgba(0,0,0,.55); display:block">
    <button id="guideBack" class="btn-mini">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
  </div>
</div>

<!-- ===== HUD ===== -->
<div class="hud">
  <div class="left">
    <div class="stack">
      <div style="display:flex; gap:8px;">
        <button id="quickRestart" class="btn-mini">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        <button id="pauseBtn" class="btn-mini">‚è∏ ‡∏´‡∏¢‡∏∏‡∏î</button>
        <button id="camBtn" class="btn-mini">üì∑: ‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </div>
  <div class="right">
    <div class="stack" style="align-items:flex-end">
      <div id="goldWrap" class="pill gold" aria-live="polite" title="‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô"></div>
    </div>
  </div>
</div>

<!-- ===== ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ß‡∏•‡∏≤/‡πÅ‡∏ü‡∏•‡∏ä/‡πÇ‡∏ó‡∏™‡∏ï‡πå/‡∏£‡∏π‡∏õ‡∏ú‡∏• ===== -->
<div id="timebarWrap"><div id="timebar"></div></div>
<div id="flash"></div>
<div id="roundToast"></div>
<img id="ansImg" src="" alt="answer background">

<!-- ‡∏õ‡πä‡∏≠‡∏õ‡∏≠‡∏±‡∏õ‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô -->
<div id="overlay" style="visibility:hidden; opacity:0; transition:.25s; position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.55); z-index:9999">
  <div class="result-panel">
    <div class="badge" id="scoreBadge" aria-hidden="true">üèÜ</div>
    <h1 class="result-title" id="endTitle">‡∏à‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</h1>
    <div class="result-metrics">
      <div class="metric">
        <div class="label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
        <div class="value"><b id="finalScore">0</b></div>
      </div>
    </div>
    <div class="result-actions">
      <button class="btn strong" id="restartBtn">‡πÄ‡∏•‡πà‡∏ô‡∏î‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
      <button class="btn ghost" id="selectLevelBtn">‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>
  </div>
</div>

<!-- ===== ‡πÄ‡∏™‡∏µ‡∏¢‡∏á ===== -->
<audio id="hitSound" preload="auto" src="image/audio1.mp3"></audio>
<audio id="winSound" preload="auto" src="image/win2.mp3"></audio>
<audio id="bgm" preload="auto" loop src="image/bgm3.mp3"></audio>
<audio id="questionSound" preload="auto" src="image/question.mp3"></audio>
<audio id="correctSound" preload="auto" src="image/audio.mp3"></audio>
<audio id="wrongSound"   preload="auto" src="image/wrong.mp3"></audio>

<!-- ===== ‡∏õ‡∏∏‡πà‡∏° Mute / Fullscreen ===== -->
<button id="muteBtn" aria-pressed="false" title="Mute / Unmute">üîä</button>
<button id="fsBtn" aria-pressed="false" title="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠">‚õ∂</button>

<!-- ===== ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Mute (‡∏õ‡∏¥‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞ BGM) ===== -->
<script>
(function(){
  const muteBtn = document.getElementById('muteBtn');
  const bgm = document.getElementById('bgm');
  if(!muteBtn || !bgm) return;

  let isMuted = false;
  let lastBgmVolume = bgm.volume || 0.3;

  function applyMute(m){
    isMuted = !!m;
    if(isMuted){
      lastBgmVolume = bgm.volume || lastBgmVolume;
      bgm.muted = true;
      bgm.pause();
    }else{
      bgm.muted = false;
      bgm.volume = lastBgmVolume;
      bgm.play?.().catch(()=>{});
    }
    muteBtn.setAttribute('aria-pressed', String(isMuted));
    muteBtn.textContent = isMuted ? 'üîá' : 'üîä';
  }

  muteBtn.addEventListener('click', () => applyMute(!isMuted));
})();
</script>

<!-- ===== ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Fullscreen ===== -->
<script>
(function(){
  const fsBtn = document.getElementById('fsBtn');
  if (!fsBtn) return;
  function fsEnabled(){ return document.fullscreenEnabled || document.webkitFullscreenEnabled || document.msFullscreenEnabled }
  function isFull(){ return document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement }
  function requestFS(){ const el=document.documentElement; (el.requestFullscreen||el.webkitRequestFullscreen||el.msRequestFullscreen)?.call(el) }
  function exitFS(){ (document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen)?.call(document) }
  function render(){ const on=!!isFull(); fsBtn.setAttribute('aria-pressed', String(on)); fsBtn.title = on ? '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠' : '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠'; fsBtn.textContent = on ? 'üóó' : '‚õ∂' }
  if (!fsEnabled()){ fsBtn.style.display='none'; return }
  fsBtn.addEventListener('click', () => { if(isFull()) exitFS(); else requestFS() });
  document.addEventListener('fullscreenchange', render);
  document.addEventListener('webkitfullscreenchange', render);
  document.addEventListener('msfullscreenchange', render);
  render();
})();
</script>

<!-- ===== ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡∏°: ‡∏ü‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ===== -->
<script>
(()=>{

  // üîπ ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ + ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° (‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô)
  let startCountdownTimer = null;

  function clearStartCountdown(){
    if(startCountdownTimer){
      clearInterval(startCountdownTimer);
      startCountdownTimer = null;
    }
    const countdownEl = document.getElementById('countdown');
    const startBtn = document.getElementById('startBtn');

    if(countdownEl){
      countdownEl.style.display = 'none';
      countdownEl.textContent = '3';
    }
    if(startBtn){
      startBtn.disabled = false;
      startBtn.style.pointerEvents = 'auto';
      startBtn.style.display = 'inline-block';
    }
  }

/* ---------- DOM ‡∏´‡∏•‡∏±‡∏Å ---------- */
const qBox   = document.getElementById('questionBox');
const qBoxTop = document.getElementById('questionBoxTop');
const qEmoji = document.getElementById('qEmoji');
const qSprite = document.getElementById('questionSprite');
const overlay= document.getElementById('overlay');
const zoneAlert = document.getElementById('zoneAlert');   // ‡∏£‡∏π‡∏õ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô
const finalScoreEl = document.getElementById('finalScore');
const restartBtn   = document.getElementById('restartBtn');
const selectLevelBtn = document.getElementById('selectLevelBtn');
const pauseBtn = document.getElementById('pauseBtn');
const quickRestart = document.getElementById('quickRestart');

const bgm = document.getElementById('bgm');
const hitSound = document.getElementById('hitSound');
const winSound = document.getElementById('winSound');
const correctSound = document.getElementById('correctSound');
const wrongSound   = document.getElementById('wrongSound');
const questionSound = document.getElementById('questionSound');

const goldWrap = document.getElementById('goldWrap');
const clockEl  = document.createElement('div');  /* ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ (‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ) */
clockEl.id = 'clock';
clockEl.className = 'clock-pill';
clockEl.textContent = '02:00';
clockEl.style.display = 'none';
document.body.appendChild(clockEl);

/* ---------- ‡πÄ‡∏™‡∏µ‡∏¢‡∏á ---------- */
const VOL = {
  bgm: 0.15,
  hit: 1,
  win: 1,
  correct: 1.0,
  wrong: 1.0,
  question: 0.9
};
if (bgm) bgm.volume = VOL.bgm;
if (hitSound) hitSound.volume = VOL.hit;
if (winSound) winSound.volume = VOL.win;
if (correctSound) correctSound.volume = VOL.correct;
if (wrongSound) wrongSound.volume = VOL.wrong;
if (questionSound) questionSound.volume = VOL.question;

function playClone(el, v){
  try{
    const a = el?.cloneNode(true);
    if(!a) return;
    a.volume = v;
    a.currentTime = 0;
    a.play?.();
  }catch(_){}
}

/* ---------- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô / ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ---------- */
let score = 0;
let emojiHistory = [];

const SCORE_EMOJI_POSITIVE = [
  'üí¢'
];
const SCORE_EMOJI_NEGATIVE = [
  'üí¢'
];

// ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏ò‡∏µ‡∏°‡∏ó‡∏∞‡πÄ‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö (‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á)
const SEA_EMOJIS = [
  'üêü','üê†','üê°','ü¶Ä','ü¶ê','ü¶ë','üêô','ü™º','ü¶û','üêö','ü™º','ü¶™','üåø','üçÉ','ü•¨','üçÄ','üçÑ','ü¶†','ü™±'
];

function pickScoreEmoji(ok){
  const pool = ok ? SCORE_EMOJI_POSITIVE : SCORE_EMOJI_NEGATIVE;
  if(!pool.length) return ok ? 'üëç' : 'üò°';
  return pool[(Math.random()*pool.length)|0];
}


function renderGold(n){
  if(!goldWrap) return;

  const s = Math.max(0, Number(n)||0);
  const max = MAX_HITS;  // ‡πÉ‡∏ä‡πâ MAX_HITS ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏Ç‡∏≠‡∏á‡∏´‡∏•‡∏≠‡∏î

  // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á 0 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô
  if(s <= 0){
    goldWrap.style.display = 'none';
    goldWrap.innerHTML = '';
    goldWrap.removeAttribute('aria-label');
    return;
  }

  // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  goldWrap.style.display = 'inline-flex';

  // ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏´‡∏•‡∏≠‡∏î (0‚Äì1)
  const ratio = max > 0 ? Math.min(1, s / max) : 0;

  // HTML ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô: ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç + ‡∏´‡∏•‡∏≠‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  goldWrap.innerHTML = `
    <span class="score-num">${s}</span>
    <div class="score-bar" aria-hidden="true">
      <div class="score-bar-fill"></div>
    </div>
  `;

  // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏´‡∏•‡∏≠‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  const fill = goldWrap.querySelector('.score-bar-fill');
  if(fill){
    fill.style.transform = `scaleX(${ratio})`;
  }

  goldWrap.setAttribute('aria-label',`‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ${s} ‡∏à‡∏≤‡∏Å ${max} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`);
}

/* ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏•‡∏≠‡∏¢‡∏à‡∏≤‡∏Å element ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
function flyScoreAtCenter(ok, anchorEl, offsetX=0, offsetY=-40){
  const sp = document.createElement('div');
  sp.className = 'fly-score ' + (ok ? 'ok' : 'bad');
  sp.textContent = pickScoreEmoji(ok);
  if(anchorEl){
    const r = anchorEl.getBoundingClientRect();
    const x = r.left + r.width/2 + offsetX;
    const y = r.top  + r.height/2 + offsetY;
    sp.style.left = x + 'px';
    sp.style.top  = y + 'px';
  }else{
    sp.style.left = (innerWidth/2)+'px';
    sp.style.top  = (innerHeight/2)+'px';
  }
  document.body.appendChild(sp);
  sp.addEventListener('animationend', ()=>sp.remove(), {once:true});
}

/* ---------- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πà‡∏≤‡∏ô / pool ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ---------- */
/*
  ‡∏î‡πà‡∏≤‡∏ô 1 : ‡∏´ ‡∏ô‡∏≥ 
  ‡∏î‡πà‡∏≤‡∏ô 2 : ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏π‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏ô‡∏≥
  ‡∏î‡πà‡∏≤‡∏ô 3 : ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏≥
*/
const LEVELS = {
  1: {
    key: 1,
    title: '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à : ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏´ ‡∏ô‡∏≥',
    question: '‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏´ ‡∏ô‡∏≥',
    correct: [
  '‡∏´‡∏ç‡∏¥‡∏á','‡∏´‡∏¢‡∏∏‡∏î','‡∏´‡∏¢‡∏¥‡∏ö','‡∏´‡∏¢‡∏≠‡∏Å','‡∏´‡∏¢‡πà‡∏≠‡∏ô','‡∏´‡∏¢‡∏≤‡∏î','‡∏´‡∏¢‡∏≤‡∏Å‡πÑ‡∏¢‡πà','‡∏´‡∏¢‡∏≤‡∏ö','‡∏´‡∏¢‡∏±‡∏Å','‡∏´‡∏¢‡∏î',
  '‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢','‡∏´‡∏•‡∏±‡∏á','‡∏´‡∏•‡∏±‡∏ö','‡∏´‡∏•‡∏ß‡∏°','‡∏´‡∏•‡∏ß‡∏á','‡∏´‡∏•‡∏≠‡∏Å','‡∏´‡∏•‡∏≠‡∏°','‡∏´‡∏•‡πà‡∏≠','‡∏´‡∏•‡πà‡∏ô','‡∏´‡∏•‡∏±‡∏Å',
  '‡∏´‡∏•‡∏á','‡∏´‡∏•‡∏ö','‡∏´‡∏•‡∏∏‡∏î','‡∏´‡∏•‡∏≤‡∏ô','‡∏´‡∏•‡∏≤‡∏¢','‡∏´‡∏•‡∏≤‡∏Å','‡∏´‡∏•‡∏≤','‡∏´‡∏•‡∏≠‡∏î','‡∏´‡∏•‡πà‡∏≠‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á','‡∏´‡∏•‡πà‡∏≠‡∏ô',
  '‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ','‡∏´‡∏°‡∏≠‡∏ô','‡∏´‡∏°‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢','‡∏Å‡∏∞‡πÇ‡∏´‡∏•‡∏Å','‡∏ï‡∏∞‡∏´‡∏•‡∏¥‡∏ß','‡∏´‡∏•‡∏µ‡∏Å','‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á','‡∏á‡∏π‡∏´‡∏•‡∏≤‡∏°','‡∏´‡∏•‡∏∏‡∏°','‡πÄ‡∏´‡∏•‡∏ô',
  '‡∏´‡∏ß‡∏±‡∏á','‡∏´‡∏ß‡∏≤‡∏ô','‡∏´‡∏ß‡∏≤‡∏î','‡∏´‡∏ß‡∏±‡πà‡∏ô','‡∏´‡∏ß‡∏∏‡∏î‡∏´‡∏ß‡∏¥‡∏î','‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á','‡∏•‡∏π‡∏Å‡∏´‡∏ß‡πâ‡∏≤','‡∏´‡∏ß‡∏¥‡∏ß','‡∏´‡∏ß‡πà‡∏≤‡∏ô','‡πÄ‡∏´‡∏ß‡∏≠',
  '‡∏´‡∏ß‡∏µ','‡∏ô‡∏Å‡∏´‡∏ß‡∏µ‡∏î','‡∏´‡∏ô‡πà‡∏ß‡∏á','‡∏´‡∏°‡∏±‡πâ‡∏ô‡∏´‡∏°‡∏≤‡∏¢','‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î','‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á','‡∏´‡∏ß‡πà‡∏≤‡∏ô‡∏•‡πâ‡∏≠‡∏°','‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î','‡∏´‡∏ß‡∏±‡πà‡∏ô‡πÑ‡∏´‡∏ß','‡∏´‡∏ß‡∏∑‡∏≠‡∏´‡∏ß‡∏≤',
  '‡∏´‡∏•‡∏≠‡∏Å','‡∏´‡∏£‡∏π','‡∏´‡∏ô‡∏∂‡πà‡∏á','‡πÄ‡∏ö‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏≤‡∏¢','‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç','‡πÄ‡∏´‡∏ß‡∏µ‡πà‡∏¢‡∏á','‡∏´‡∏£‡∏≠‡∏°‡πÅ‡∏´‡∏£‡∏°','‡∏´‡∏£‡∏∑‡∏≠','‡∏õ‡∏£‡∏∞‡∏´‡∏•‡∏≤‡∏î','‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å','‡∏™‡∏≤‡∏´‡∏£‡πà‡∏≤‡∏¢','‡∏Å‡∏£‡∏∞‡∏´‡∏ô‡πà‡∏≥',
  '‡∏á‡∏π‡∏´‡∏•‡∏≤‡∏°','‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß','‡πÄ‡∏´‡∏•‡πá‡∏Å','‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á','‡πÄ‡∏´‡∏•‡∏∑‡∏≠','‡∏á‡∏π‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏°','‡πÄ‡∏´‡∏•‡πâ‡∏≤','‡∏à‡∏¥‡πâ‡∏á‡πÄ‡∏´‡∏•‡∏ô','‡πÄ‡∏Å‡∏≤‡πÄ‡∏´‡∏•‡∏≤','‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ö‡πÑ‡∏£','‡∏´‡∏°‡∏µ','‡πÉ‡∏´‡∏°‡πà','‡∏ú‡πâ‡∏≤‡πÑ‡∏´‡∏°','‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ','‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà',
  '‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏á','‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢','‡πÄ‡∏´‡∏ô‡πá‡∏ö','‡πÄ‡∏´‡∏ô‡∏≠‡∏∞‡∏´‡∏ô‡∏∞','‡∏Å‡∏∞‡πÄ‡∏´‡∏£‡∏µ‡πà‡∏¢‡∏á','‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß','‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏£‡∏±‡πâ‡∏á','‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏´‡∏ô‡∏∂‡∏ö','‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥','‡∏´‡∏ô‡∏∏‡πà‡∏°','‡∏´‡∏°‡∏π','‡∏´‡∏°‡∏≤','‡∏´‡∏ô‡∏π','‡∏´‡∏ô‡∏≠‡∏ô','‡∏´‡∏ô‡πà‡∏≠‡πÑ‡∏°‡πâ','‡∏´‡∏ô‡∏∑‡∏î',
],
    wrong: [
      '‡∏´‡∏ß‡∏¢','‡∏´‡∏≤‡∏ß','‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ó','‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£','‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®','‡∏´‡∏≠‡∏ö','‡∏´‡∏Å‡∏•‡πâ‡∏°','‡∏´‡∏µ‡∏ö‡∏´‡πà‡∏≠','‡∏´‡∏ó‡∏±‡∏¢','‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ',
  '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥','‡∏õ‡∏•‡∏±‡∏î','‡∏™‡∏≤‡∏°‡∏µ','‡∏™‡∏£‡∏∏‡∏õ','‡πÇ‡∏à‡∏£‡∏™‡∏•‡∏±‡∏î','‡∏´‡∏±‡∏ß‡πÉ‡∏à','‡∏´‡πâ‡∏≠‡∏á','‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç','‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç',
  '‡∏Ñ‡∏ß‡∏±‡∏ô‡πÑ‡∏ü','‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç','‡∏Å‡∏•‡∏±‡∏ß','‡∏Ç‡∏±‡∏î‡πÄ‡∏Å‡∏•‡∏≤','‡πÄ‡∏Å‡∏•‡πâ‡∏≤','‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡∏•‡πà‡∏≤','‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à','‡∏à‡∏£‡∏ß‡∏î','‡∏ï‡∏£‡∏ß‡∏à','‡∏´‡∏ô‡∏ó‡∏≤‡∏á',
  '‡∏´‡πà‡∏°‡∏ú‡πâ‡∏≤','‡∏´‡πâ‡∏≠‡∏°‡∏•‡πâ‡∏≠‡∏°','‡∏ï‡πâ‡∏ô‡πÑ‡∏ó‡∏£','‡∏ó‡∏£‡∏≤‡∏¢','‡∏®‡∏£‡∏µ','‡∏õ‡∏•‡∏µ','‡πÇ‡∏Å‡∏£‡∏ò','‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡∏•‡∏≠‡∏Å','‡πÄ‡∏û‡∏•‡∏á','‡∏û‡∏•‡∏±‡∏î‡∏û‡∏£‡∏≤‡∏Å',
  '‡∏û‡∏∏‡∏ó‡∏ò','‡∏Å‡∏ß‡πà‡∏≤','‡∏Å‡∏£‡∏£‡πÑ‡∏Å‡∏£','‡πÄ‡∏´‡∏≤‡∏∞','‡∏Ñ‡∏ß‡∏≤‡∏¢','‡πÑ‡∏Ç‡∏ß‡πà‡∏Ñ‡∏ß‡πâ‡∏≤','‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ß','‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô','‡∏Ç‡∏ß‡∏≤‡∏ô','‡πÅ‡∏Ç‡∏ß‡∏ô',
  '‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£','‡∏´‡∏±‡∏ß‡∏õ‡∏•‡∏µ','‡∏´‡∏∏‡∏á‡∏Ç‡πâ‡∏≤‡∏ß','‡∏ä‡∏≤‡∏¢‡∏´‡∏≤‡∏î','‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß','‡∏õ‡∏•‡∏≠‡∏ö','‡πÄ‡∏õ‡∏•‡πà‡∏≤','‡πÅ‡∏õ‡∏•','‡∏õ‡∏•‡∏≤','‡πÄ‡∏õ‡∏•',
  '‡πÅ‡∏ú‡∏•','‡πÄ‡∏ú‡∏•‡∏≠','‡∏ú‡∏•‡∏±‡∏Å','‡∏ú‡∏•‡∏±‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô','‡∏û‡∏£‡∏≤‡∏ô','‡∏û‡∏•‡∏π','‡∏Ñ‡∏£‡∏π','‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏π‡πà','‡∏Ñ‡∏£‡πà‡∏≥‡∏Ñ‡∏£‡πà‡∏≤','‡πÉ‡∏Ñ‡∏£',
  '‡πÑ‡∏Å‡∏•','‡πÉ‡∏Å‡∏•‡πâ','‡πÑ‡∏Å‡∏ß','‡πÅ‡∏ï‡∏£','‡∏û‡∏•‡∏µ','‡πÄ‡∏Å‡πÄ‡∏£','‡∏Å‡∏∞‡∏•‡∏≤','‡∏û‡∏±‡∏í‡∏ô‡∏≤','‡∏û‡∏ç‡∏≤','‡∏ä‡∏ß‡∏≤','‡∏ñ‡∏±‡∏Å‡∏ó‡∏≠','‡πÉ‡∏´‡πâ','‡∏´‡∏¥‡∏ß‡πÇ‡∏´‡∏¢','‡∏ô‡πâ‡∏≥‡∏´‡∏≠‡∏°','‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß',
  '‡∏™‡πâ‡∏°‡πÇ‡∏≠','‡∏™‡∏≤‡∏°‡∏´‡∏≤‡∏ß','‡∏´‡πà‡∏ß‡∏á‡πÉ‡∏¢','‡∏£‡∏∞‡πÅ‡∏´‡∏á','‡πÄ‡∏à‡∏£‡∏¥‡∏ç','‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏¥‡∏ô','‡πÄ‡∏´‡πá‡∏ö','‡πÄ‡∏´‡πá‡∏î','‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏à','‡∏´‡∏≠‡∏ö','‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πà‡∏≤','‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô','‡∏ó‡∏ß‡∏µ','‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°','‡∏û‡∏£‡∏∞‡∏™‡∏á‡∏´‡πå','‡∏û‡∏£‡πâ‡∏≠‡∏°',
    ]
  },


  2: {
    key: 2,
    title: '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à : ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏π‡∏á‡∏ô‡∏≥‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏ô‡∏≥',
    question: '‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏π‡∏á/‡∏Å‡∏•‡∏≤‡∏á‡∏ô‡∏≥',
    correct: [
      '‡∏™‡∏ô‡∏≤‡∏°','‡∏™‡∏ô‡∏≠‡∏á','‡∏™‡∏ô‡∏∏‡∏Å‡∏™‡∏ô‡∏≤‡∏ô','‡πÄ‡∏™‡∏°‡∏≠','‡∏™‡∏°‡∏≠','‡∏™‡∏á‡∏ö','‡∏™‡∏á‡πà‡∏≤','‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå','‡∏Ç‡∏ô‡∏∏‡∏ô','‡∏Ç‡∏ô‡∏°',
  '‡∏Ç‡∏ô‡∏ö','‡∏Ç‡∏ô‡∏≤‡∏î','‡∏Ç‡∏¢‡πà‡∏°','‡∏Ç‡∏¢‡∏≥','‡∏Ç‡∏¢‡∏µ‡πâ','‡∏Ç‡∏°‡∏ß‡∏î','‡πÄ‡∏Ç‡∏°‡πà‡∏≤','‡∏Ç‡∏¢‡∏≤‡∏¢','‡∏Ç‡∏¢‡∏±‡∏ö‡πÄ‡∏Ç‡∏¢‡∏∑‡πâ‡∏≠‡∏ô','‡∏â‡∏•‡∏≤‡∏°',
  '‡∏â‡∏•‡∏π','‡∏â‡∏•‡∏≠‡∏á','‡πÄ‡∏â‡∏•‡∏¥‡∏°','‡∏â‡∏•‡∏≤‡∏î','‡πÄ‡∏â‡∏•‡∏µ‡∏¢‡∏ß‡∏â‡∏•‡∏≤‡∏î','‡πÅ‡∏â‡∏•‡∏ö','‡∏ñ‡∏•‡∏≤','‡∏ñ‡∏•‡∏≠‡∏Å','‡πÑ‡∏ñ‡∏•','‡∏ñ‡∏•‡πà‡∏°',
  '‡πÄ‡∏ñ‡∏•‡πÑ‡∏ñ‡∏•','‡∏ñ‡∏ß‡∏≤‡∏¢','‡∏Ç‡∏¢‡∏∞','‡∏Ç‡∏¢‡∏∞‡πÅ‡∏Ç‡∏¢‡∏á','‡∏ú‡∏ô‡∏±‡∏á','‡∏ú‡∏¢‡∏≠‡∏á','‡∏ú‡∏•‡∏¥‡∏ï','‡∏ú‡∏ß‡∏≤','‡∏ù‡∏£‡∏±‡πà‡∏á','‡∏™‡∏¢‡∏≤‡∏°',
  '‡∏™‡∏¢‡∏≠‡∏á','‡∏™‡∏£‡∏∞‡∏≠‡∏µ','‡∏™‡∏•‡∏±‡∏ö','‡πÇ‡∏à‡∏£‡∏™‡∏•‡∏±‡∏î','‡∏™‡∏•‡∏±‡∏Å','‡∏™‡∏°‡∏∏‡∏î','‡∏™‡∏°‡∏±‡∏¢','‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢','‡πÇ‡∏â‡∏ô‡∏î','‡∏™‡∏°‡∏≠‡∏á',
  '‡∏™‡∏•‡∏ö','‡∏Ç‡∏ô‡∏ö‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°','‡πÅ‡∏ú‡∏ô‡∏Å','‡∏ú‡∏ô‡∏ß‡∏Å','‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠','‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå','‡πÅ‡∏™‡∏ß‡∏á‡∏´‡∏≤','‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ','‡πÑ‡∏™‡∏ß','‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà',
  '‡∏™‡∏ô‡∏¥‡∏°','‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô','‡πÇ‡∏Ç‡∏¢‡∏á','‡πÇ‡∏Ç‡∏¢‡∏Å‡πÄ‡∏Ç‡∏¢‡∏Å','‡∏Ç‡∏¢‡∏∏‡∏Å‡∏Ç‡∏¢‡∏¥‡∏Å','‡∏™‡∏•‡∏≤‡∏¢','‡∏ñ‡∏ô‡∏±‡∏î','‡∏Ç‡∏¢‡∏¥‡∏ö‡∏ï‡∏≤','‡∏Ç‡∏ô‡∏á','‡∏Ç‡∏ô‡∏≤‡∏ô',
  '‡∏≠‡∏£‡πà‡∏≤‡∏°','‡∏≠‡∏£‡πà‡∏≠‡∏¢','‡∏à‡∏°‡∏π‡∏Å','‡∏Å‡∏ô‡∏Å','‡∏à‡∏£‡∏¥‡∏ï','‡∏à‡∏£‡∏ß‡∏î','‡∏à‡∏ß‡∏±‡∏Å','‡∏ï‡∏•‡∏≠‡∏î','‡∏à‡∏£‡∏î','‡∏à‡∏£‡∏±‡∏™',
  '‡∏ï‡∏•‡∏Å','‡∏ï‡∏•‡∏≤‡∏î','‡∏ï‡∏ß‡∏±‡∏î','‡∏ï‡∏ß‡∏≤‡∏î','‡∏≠‡∏£‡πà‡∏≠‡∏¢','‡∏≠‡∏£‡πà‡∏≤‡∏°','‡∏Ñ‡∏π‡πà‡∏≠‡∏£‡∏¥','‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå','‡∏≠‡∏ô‡∏≤‡∏ñ',
  '‡∏ï‡∏•‡∏ö‡∏´‡∏•‡∏±‡∏á','‡∏õ‡∏•‡∏±‡∏î','‡∏õ‡∏£‡∏≠‡∏ó','‡∏à‡∏°‡∏π‡∏Å','‡∏ï‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ï‡∏£','‡∏ï‡∏•‡∏¥‡πà‡∏á‡∏ä‡∏±‡∏ô','‡πÄ‡∏ï‡πà‡∏≤‡∏ï‡∏ô‡∏∏','‡∏ï‡∏ß‡∏≤‡∏î','‡πÄ‡∏≠‡∏£‡πá‡∏î‡∏≠‡∏£‡πà‡∏≠‡∏¢','‡∏≠‡∏ô‡∏≤‡∏ñ','‡∏≠‡∏á‡∏∏‡πà‡∏ô','‡∏≠‡∏£‡∏¥',
    ],
    wrong: [
      '‡πÅ‡∏™‡∏î‡∏á','‡∏™‡∏†‡∏≤','‡∏™‡∏î‡∏∏‡∏î‡∏µ','‡∏™‡πÑ‡∏ö','‡∏™‡∏∞‡∏≠‡∏≤‡∏î','‡∏™‡∏°‡∏≤‡∏ò‡∏¥','‡∏Ç‡∏à‡∏µ','‡∏Ç‡∏à‡∏£','‡∏ä‡∏ô‡∏ß‡∏ô','‡∏ä‡∏£‡∏≤',
  '‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô','‡∏ä‡∏£‡∏≤‡∏†‡∏≤‡∏û','‡∏ä‡∏∞‡∏ï‡∏≤','‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å','‡∏™‡∏∞‡∏î‡∏∑‡∏≠','‡∏™‡∏∞‡πÄ‡∏î‡∏≤','‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥','‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á','‡∏≠‡∏¢‡πà‡∏≤','‡∏ú‡∏î‡∏∏‡∏á',
  '‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç','‡∏™‡∏ï‡∏¥','‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå','‡∏ô‡∏Ñ‡∏£','‡∏ß‡∏•‡∏µ','‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢','‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï','‡∏ï‡∏≥‡∏£‡∏ß‡∏à','‡∏ï‡∏≥‡∏£‡∏±‡∏ö','‡πÄ‡∏à‡∏£‡∏¥‡∏ç',
  '‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ','‡∏Å‡∏±‡∏á‡∏ß‡∏•','‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î','‡∏à‡∏≥‡∏Å‡∏±‡∏î','‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏®','‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö','‡∏Å‡∏£‡∏¥‡∏¢‡∏≤','‡∏Å‡∏•‡πâ‡∏ß‡∏¢','‡∏Ç‡πÇ‡∏°‡∏¢','‡∏£‡∏∞‡πÅ‡∏ß‡∏á',
  '‡∏õ‡∏•‡πâ‡∏ô','‡∏õ‡∏•‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢','‡∏Å‡∏ß‡∏µ','‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó','‡∏ï‡∏£‡∏á','‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á','‡∏Å‡∏•‡∏≠‡∏á','‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤','‡∏Å‡∏£‡∏∞‡∏ï‡πà‡∏≤‡∏¢','‡∏ï‡∏£‡∏∞‡πÄ‡∏ß‡∏ô',
  '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô','‡∏î‡∏≥‡∏£‡∏¥','‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£','‡∏à‡∏£‡∏≤‡∏à‡∏£','‡∏Ñ‡∏ë‡∏≤','‡πÄ‡∏ó‡∏ß‡∏î‡∏≤','‡∏ï‡∏∞‡∏Å‡∏•‡∏∞','‡∏°‡∏´‡∏±‡∏®‡∏à‡∏£‡∏£‡∏¢‡πå','‡∏ó‡∏ô‡∏≤‡∏¢','‡∏û‡∏•‡∏≤‡∏¢','‡∏Ç‡∏≠‡∏Ç‡∏°‡∏≤','‡∏™‡∏°‡∏≤‡∏Ñ‡∏°','‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£',
  '‡∏™‡∏ö‡∏π‡πà','‡∏™‡∏ö‡∏≤‡∏¢','‡∏™‡∏õ‡∏≤','‡∏ò‡∏ô‡∏π','‡∏™‡πÑ‡∏ï‡∏•‡πå','‡∏®‡∏±‡∏ï‡∏£‡∏π','‡∏û‡∏∏‡∏ó‡∏£‡∏≤','‡∏ï‡πâ‡∏ô‡πÑ‡∏ó‡∏£','‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à','‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠','‡∏ä‡∏£‡∏≤','‡∏û‡∏•‡∏±‡∏á','‡∏ï‡∏≥‡∏£‡∏ß‡∏à','‡∏™‡∏≥‡∏£‡∏≤‡∏ç','‡∏î‡∏≥‡∏£‡∏±‡∏™','‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå','‡∏™‡∏≥‡∏£‡∏ß‡∏à','‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç','‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
  '‡∏™‡∏≥‡∏£‡∏≤‡∏°','‡∏≠‡∏ô‡∏≤‡∏à‡∏≤‡∏£','‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥','‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò','‡∏õ‡∏£‡∏Å‡∏ï‡∏¥','‡∏õ‡∏•‡∏≤‡∏¢','‡πÄ‡∏õ‡∏•‡∏ß‡πÑ‡∏ü','‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£','‡∏î‡∏£‡∏∏‡∏ì‡∏µ','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤',
  '‡∏û‡∏ç‡∏≤‡∏ô‡∏≤‡∏Ñ','‡∏ú‡∏•‡∏û‡∏ß‡∏á','‡∏û‡∏•‡∏µ‡∏ä‡∏µ‡∏û','‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£','‡∏õ‡∏•‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢','‡∏õ‡∏•‡∏≠‡∏°‡πÅ‡∏õ‡∏•‡∏á','‡∏®‡∏£‡∏±‡∏ó‡∏ò‡∏≤','‡∏®‡∏£‡∏µ','‡πÄ‡∏®‡∏£‡πâ‡∏≤‡πÇ‡∏®‡∏Å','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','‡πÄ‡∏™‡∏£‡πá‡∏à','‡∏Å‡∏£‡∏≤‡∏°','‡∏Å‡∏•‡πâ‡∏≤‡∏°‡∏õ‡∏π','‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå','‡∏≠‡∏û‡∏¢‡∏ö',
    ]
  },
  3: {
    key: 3,
    title: '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à : ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏≥',
    question: '‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ô‡∏≥',
    correct: [
      '‡∏≠‡∏¢‡πà‡∏≤','‡∏≠‡∏¢‡∏π‡πà','‡∏≠‡∏¢‡πà‡∏≤‡∏á','‡∏≠‡∏¢‡∏≤‡∏Å','‡∏≠‡∏î‡∏≠‡∏¢‡∏≤‡∏Å','‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡∏π‡πà','‡∏´‡∏¢‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏á','‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á','‡πÅ‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á','‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà',
   '‡∏™‡∏ô‡∏≤‡∏°','‡∏™‡∏ô‡∏≠‡∏á','‡∏™‡∏ô‡∏∏‡∏Å‡∏™‡∏ô‡∏≤‡∏ô','‡πÄ‡∏™‡∏°‡∏≠','‡∏™‡∏°‡∏≠','‡∏™‡∏á‡∏ö','‡∏™‡∏á‡πà‡∏≤','‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå','‡∏Ç‡∏ô‡∏∏‡∏ô','‡∏Ç‡∏ô‡∏°',
  '‡∏Ç‡∏ô‡∏ö','‡∏Ç‡∏ô‡∏≤‡∏î','‡∏Ç‡∏¢‡πà‡∏°','‡∏Ç‡∏¢‡∏≥','‡∏Ç‡∏¢‡∏µ‡πâ','‡∏Ç‡∏°‡∏ß‡∏î','‡πÄ‡∏Ç‡∏°‡πà‡∏≤','‡∏Ç‡∏¢‡∏≤‡∏¢','‡∏Ç‡∏¢‡∏±‡∏ö‡πÄ‡∏Ç‡∏¢‡∏∑‡πâ‡∏≠‡∏ô','‡∏â‡∏•‡∏≤‡∏°',
  '‡∏â‡∏•‡∏π','‡∏â‡∏•‡∏≠‡∏á','‡πÄ‡∏â‡∏•‡∏¥‡∏°','‡∏â‡∏•‡∏≤‡∏î','‡πÄ‡∏â‡∏•‡∏µ‡∏¢‡∏ß‡∏â‡∏•‡∏≤‡∏î','‡πÅ‡∏â‡∏•‡∏ö','‡∏ñ‡∏•‡∏≤','‡∏ñ‡∏•‡∏≠‡∏Å','‡πÑ‡∏ñ‡∏•','‡∏ñ‡∏•‡πà‡∏°',
  '‡πÄ‡∏ñ‡∏•‡πÑ‡∏ñ‡∏•','‡∏ñ‡∏ß‡∏≤‡∏¢','‡∏Ç‡∏¢‡∏∞','‡∏Ç‡∏¢‡∏∞‡πÅ‡∏Ç‡∏¢‡∏á','‡∏ú‡∏ô‡∏±‡∏á','‡∏ú‡∏¢‡∏≠‡∏á','‡∏ú‡∏•‡∏¥‡∏ï','‡∏ú‡∏ß‡∏≤','‡∏ù‡∏£‡∏±‡πà‡∏á','‡∏™‡∏¢‡∏≤‡∏°',
  '‡∏™‡∏ô‡∏¥‡∏°','‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô','‡πÇ‡∏Ç‡∏¢‡∏á','‡πÇ‡∏Ç‡∏¢‡∏Å‡πÄ‡∏Ç‡∏¢‡∏Å','‡∏Ç‡∏¢‡∏∏‡∏Å‡∏Ç‡∏¢‡∏¥‡∏Å','‡∏™‡∏•‡∏≤‡∏¢','‡∏ñ‡∏ô‡∏±‡∏î','‡∏Ç‡∏¢‡∏¥‡∏ö‡∏ï‡∏≤','‡∏Ç‡∏ô‡∏á','‡∏Ç‡∏ô‡∏≤‡∏ô',

  '‡∏≠‡∏£‡πà‡∏≤‡∏°','‡∏≠‡∏£‡πà‡∏≠‡∏¢','‡∏à‡∏°‡∏π‡∏Å','‡∏Å‡∏ô‡∏Å','‡∏à‡∏£‡∏¥‡∏ï','‡∏à‡∏£‡∏ß‡∏î','‡∏à‡∏ß‡∏±‡∏Å','‡∏ï‡∏•‡∏≠‡∏î','‡∏à‡∏£‡∏î','‡∏à‡∏£‡∏±‡∏™',
  '‡∏ï‡∏•‡∏Å','‡∏ï‡∏•‡∏≤‡∏î','‡∏ï‡∏ß‡∏±‡∏î','‡∏ï‡∏ß‡∏≤‡∏î','‡∏≠‡∏£‡πà‡∏≠‡∏¢','‡∏≠‡∏£‡πà‡∏≤‡∏°','‡∏Ñ‡∏π‡πà‡∏≠‡∏£‡∏¥','‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå','‡∏≠‡∏ô‡∏≤‡∏ñ',
  '‡∏ï‡∏•‡∏ö‡∏´‡∏•‡∏±‡∏á','‡∏õ‡∏•‡∏±‡∏î','‡∏õ‡∏£‡∏≠‡∏ó','‡∏à‡∏°‡∏π‡∏Å','‡∏ï‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ï‡∏£','‡∏ï‡∏•‡∏¥‡πà‡∏á‡∏ä‡∏±‡∏ô','‡πÄ‡∏ï‡πà‡∏≤‡∏ï‡∏ô‡∏∏','‡∏ï‡∏ß‡∏≤‡∏î','‡πÄ‡∏≠‡∏£‡πá‡∏î‡∏≠‡∏£‡πà‡∏≠‡∏¢','‡∏≠‡∏ô‡∏≤‡∏ñ','‡∏≠‡∏á‡∏∏‡πà‡∏ô','‡∏≠‡∏£‡∏¥',

  '‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á','‡∏´‡∏¢‡∏∏‡∏î','‡∏´‡∏¢‡∏¥‡∏ö','‡∏´‡∏¢‡∏≠‡∏Å','‡∏´‡∏¢‡πà‡∏≠‡∏ô','‡∏´‡∏¢‡∏≤‡∏î','‡∏´‡∏¢‡∏≤‡∏Å‡πÑ‡∏¢‡πà','‡∏´‡∏¢‡∏≤‡∏ö','‡∏´‡∏¢‡∏±‡∏Å','‡∏´‡∏¢‡∏î',
  '‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢','‡∏´‡∏•‡∏±‡∏á','‡∏´‡∏•‡∏±‡∏ö','‡∏´‡∏•‡∏ß‡∏°','‡∏´‡∏•‡∏ß‡∏á','‡∏´‡∏•‡∏≠‡∏Å','‡∏´‡∏•‡∏≠‡∏°','‡∏´‡∏•‡πà‡∏≠','‡∏´‡∏•‡πà‡∏ô','‡∏´‡∏•‡∏±‡∏Å',
  '‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ','‡∏´‡∏°‡∏≠‡∏ô','‡∏´‡∏°‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢','‡∏Å‡∏∞‡πÇ‡∏´‡∏•‡∏Å','‡∏ï‡∏∞‡∏´‡∏•‡∏¥‡∏ß','‡∏´‡∏•‡∏µ‡∏Å','‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á','‡∏´‡∏•‡∏ß‡∏°‡∏ï‡∏±‡∏ß','‡∏´‡∏•‡∏∏‡∏°','‡∏´‡∏•‡∏∏‡∏¢',
  '‡∏´‡∏ß‡∏±‡∏á','‡∏´‡∏ß‡∏≤‡∏ô','‡∏´‡∏ß‡∏≤‡∏î','‡∏´‡∏ß‡∏±‡πà‡∏ô','‡∏´‡∏ß‡∏∏‡∏î‡∏´‡∏ß‡∏¥‡∏î','‡∏´‡∏ß‡∏á','‡∏´‡∏ß‡∏∑‡∏≠‡∏´‡∏ß‡∏≤','‡∏´‡∏ß‡∏¥‡∏ß','‡∏´‡∏ß‡πà‡∏≤‡∏ô','‡πÄ‡∏´‡∏ß‡∏≠',
  '‡∏´‡∏•‡∏≠‡∏Å','‡∏´‡∏£‡∏π','‡∏´‡∏ô‡∏∂‡πà‡∏á','‡πÄ‡∏ö‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏≤‡∏¢','‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç','‡πÄ‡∏´‡∏ß‡∏µ‡πà‡∏¢‡∏á','‡∏´‡∏£‡∏≠‡∏°‡πÅ‡∏´‡∏£‡∏°','‡∏´‡∏£‡∏∑‡∏≠','‡∏õ‡∏£‡∏∞‡∏´‡∏•‡∏≤‡∏î','‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å','‡∏™‡∏≤‡∏´‡∏£‡πà‡∏≤‡∏¢','‡∏Å‡∏£‡∏∞‡∏´‡∏ô‡πà‡∏≥',
  '‡∏á‡∏π‡∏´‡∏•‡∏≤‡∏°','‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß','‡πÄ‡∏´‡∏•‡πá‡∏Å','‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á','‡πÄ‡∏´‡∏•‡∏∑‡∏≠','‡∏á‡∏π‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏°','‡πÄ‡∏´‡∏•‡πâ‡∏≤','‡∏à‡∏¥‡πâ‡∏á‡πÄ‡∏´‡∏•‡∏ô','‡πÄ‡∏Å‡∏≤‡πÄ‡∏´‡∏•‡∏≤','‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ö‡πÑ‡∏£','‡∏´‡∏°‡∏µ','‡πÉ‡∏´‡∏°‡πà','‡∏ú‡πâ‡∏≤‡πÑ‡∏´‡∏°','‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ','‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà',
  '‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏á','‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢','‡πÄ‡∏´‡∏ô‡πá‡∏ö','‡πÄ‡∏´‡∏ô‡∏≠‡∏∞‡∏´‡∏ô‡∏∞','‡∏Å‡∏∞‡πÄ‡∏´‡∏£‡∏µ‡πà‡∏¢‡∏á','‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß','‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏£‡∏±‡πâ‡∏á','‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏´‡∏ô‡∏∂‡∏ö','‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥','‡∏´‡∏ô‡∏∏‡πà‡∏°','‡∏´‡∏°‡∏π','‡∏´‡∏°‡∏≤','‡∏´‡∏ô‡∏π','‡∏´‡∏ô‡∏≠‡∏ô','‡∏´‡∏ô‡πà‡∏≠‡πÑ‡∏°‡πâ','‡∏´‡∏ô‡∏∑‡∏î',

    ],
    wrong: [
      '‡∏™‡∏∏‡∏ô‡∏±‡∏Ç','‡πÅ‡∏°‡∏ß','‡∏ß‡∏±‡∏ß','‡∏°‡πâ‡∏≤','‡∏ä‡πâ‡∏≤‡∏á','‡∏á‡∏π','‡∏õ‡∏•‡∏≤','‡∏Å‡∏ö','‡πÄ‡∏ï‡πà‡∏≤','‡∏à‡∏£‡∏∞‡πÄ‡∏Ç‡πâ',
  '‡πÅ‡∏™‡∏î‡∏á','‡∏™‡∏†‡∏≤','‡∏™‡∏î‡∏∏‡∏î‡∏µ','‡∏™‡πÑ‡∏ö','‡∏™‡∏∞‡∏≠‡∏≤‡∏î','‡∏™‡∏°‡∏≤‡∏ò‡∏¥','‡∏Ç‡∏à‡∏µ','‡∏Ç‡∏à‡∏£','‡∏ä‡∏ô‡∏ß‡∏ô','‡∏ä‡∏£‡∏≤',
  '‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô','‡∏ä‡∏£‡∏≤‡∏†‡∏≤‡∏û','‡∏ä‡∏∞‡∏ï‡∏≤','‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å','‡∏™‡∏∞‡∏î‡∏∑‡∏≠','‡∏™‡∏∞‡πÄ‡∏î‡∏≤','‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥','‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á','‡∏≠‡∏¢‡πà‡∏≤','‡∏ú‡∏î‡∏∏‡∏á',
  '‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç','‡∏™‡∏ï‡∏¥','‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå','‡∏ô‡∏Ñ‡∏£','‡∏ß‡∏•‡∏µ','‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢','‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï','‡∏ï‡∏≥‡∏£‡∏ß‡∏à','‡∏ï‡∏≥‡∏£‡∏±‡∏ö','‡πÄ‡∏à‡∏£‡∏¥‡∏ç',
  '‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ','‡∏Å‡∏±‡∏á‡∏ß‡∏•','‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î','‡∏à‡∏≥‡∏Å‡∏±‡∏î','‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®','‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö','‡∏Å‡∏£‡∏¥‡∏¢‡∏≤','‡∏Å‡∏•‡πâ‡∏ß‡∏¢','‡∏Ç‡πÇ‡∏°‡∏¢','‡∏£‡∏∞‡πÅ‡∏ß‡∏á',
  '‡∏õ‡∏•‡πâ‡∏ô','‡∏õ‡∏•‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢','‡∏Å‡∏ß‡∏µ','‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó','‡∏ï‡∏£‡∏á','‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á','‡∏Å‡∏•‡∏≠‡∏á','‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤','‡∏Å‡∏£‡∏∞‡∏ï‡πà‡∏≤‡∏¢','‡∏ï‡∏£‡∏∞‡πÄ‡∏ß‡∏ô',
  '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô','‡∏î‡∏≥‡∏£‡∏¥','‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£','‡∏à‡∏£‡∏≤‡∏à‡∏£','‡∏Ñ‡∏ë‡∏≤','‡πÄ‡∏ó‡∏ß‡∏î‡∏≤','‡∏ï‡∏∞‡∏Å‡∏•‡∏∞','‡∏°‡∏´‡∏±‡∏®‡∏à‡∏£‡∏£‡∏¢‡πå','‡∏ó‡∏ô‡∏≤‡∏¢','‡∏û‡∏•‡∏≤‡∏¢','‡∏Ç‡∏≠‡∏Ç‡∏°‡∏≤','‡∏™‡∏°‡∏≤‡∏Ñ‡∏°','‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£',
  '‡∏™‡∏ö‡∏π‡πà','‡∏™‡∏ö‡∏≤‡∏¢','‡∏™‡∏õ‡∏≤','‡∏ò‡∏ô‡∏π','‡∏™‡πÑ‡∏ï‡∏•‡πå','‡∏®‡∏±‡∏ï‡∏£‡∏π','‡∏û‡∏∏‡∏ó‡∏£‡∏≤','‡∏ï‡πâ‡∏ô‡πÑ‡∏ó‡∏£','‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à','‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠','‡∏ä‡∏£‡∏≤','‡∏û‡∏•‡∏±‡∏á','‡∏ï‡∏≥‡∏£‡∏ß‡∏à','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','‡∏î‡∏≥‡∏£‡∏±‡∏™','‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå','‡∏™‡∏≥‡∏£‡∏ß‡∏à','‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç','‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
  '‡∏™‡∏≥‡∏£‡∏≤‡∏°','‡∏≠‡∏ô‡∏≤‡∏à‡∏≤‡∏£','‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥','‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò','‡∏õ‡∏£‡∏Å‡∏ï‡∏¥','‡∏õ‡∏•‡∏≤‡∏¢','‡πÄ‡∏õ‡∏•‡∏ß‡πÑ‡∏ü','‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£','‡∏î‡∏£‡∏∏‡∏ì‡∏µ','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤',
  '‡∏ï‡∏£‡∏≠‡∏Å','‡∏û‡∏ç‡∏≤‡∏ô‡∏≤‡∏Ñ','‡∏ú‡∏•‡∏û‡∏ß‡∏á','‡∏ï‡∏ß‡∏≤‡∏î','‡∏≠‡∏£‡πà‡∏≠‡∏¢','‡∏≠‡∏£‡πà‡∏≤‡∏°','‡∏û‡∏•‡∏µ‡∏ä‡∏µ‡∏û','‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå','‡∏≠‡∏ô‡∏≤‡∏ñ',
  '‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£','‡∏õ‡∏•‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢','‡∏õ‡∏•‡∏≠‡∏°‡πÅ‡∏õ‡∏•‡∏á','‡∏®‡∏£‡∏±‡∏ó‡∏ò‡∏≤','‡∏®‡∏£‡∏µ','‡πÄ‡∏®‡∏£‡πâ‡∏≤‡πÇ‡∏®‡∏Å','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','‡πÄ‡∏™‡∏£‡πá‡∏à','‡∏Å‡∏£‡∏≤‡∏°','‡∏Å‡∏•‡πâ‡∏≤‡∏°‡∏õ‡∏π','‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå','‡∏≠‡∏û‡∏¢‡∏ö',
    ]
  }
};

let currentLevel = 1;

/* ---------- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Å‡∏° ---------- */
let running = false;
let ended   = true;
let paused  = false;

/* ===== ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏° (‡πÄ‡∏î‡∏¥‡∏° + ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô) ===== */
const TOTAL_TIME_SEC = 120; // 2 ‡∏ô‡∏≤‡∏ó‡∏µ
let timeLeftSec = TOTAL_TIME_SEC;
let timerId = null;

function formatTime(sec){
  sec = Math.max(0, Math.floor(sec));
  const m = String(Math.floor(sec / 60)).padStart(2, '0');
  const s = String(sec % 60).padStart(2, '0');
  return `${m}:${s}`;
}

function updateClock(){
  if(!clockEl) return;
  clockEl.textContent = formatTime(timeLeftSec);
}

function startTimer(){
  if(!clockEl) return;
  clearInterval(timerId);
  timeLeftSec = TOTAL_TIME_SEC;
  updateClock();
  clockEl.style.display = 'block';

  timerId = setInterval(() => {
    // ‡πÄ‡∏Å‡∏°‡πÑ‡∏°‡πà‡∏ß‡∏¥‡πà‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÑ‡∏°‡πà‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ß‡∏•‡∏≤
    if(!running || ended) return;
    // ‡∏Å‡∏î pause ‚Üí ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô
    if(paused) return;

    timeLeftSec--;
    if(timeLeftSec <= 0){
      timeLeftSec = 0;
      updateClock();
      clearInterval(timerId);
      timerId = null;
      // ‚è∞ ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ ‚Üí ‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô
      endLevel();
    }else{
      updateClock();
    }
  }, 1000);
}

function stopTimer(){
  clearInterval(timerId);
  timerId = null;
  if(clockEl){
    clockEl.style.display = 'none';
  }
}


const MAX_HITS = 20;   // ‡∏ï‡∏≠‡∏ö/‡∏ä‡∏ô‡∏ü‡∏≠‡∏á‡∏Ñ‡∏£‡∏ö 20 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô
function getMaxBubbles(){
  return 1 + Math.floor(Math.random() * 3);
  // 1 + (0,1,2) ‚Üí ‡πÑ‡∏î‡πâ 1,2,3  ‚úÖ ‡∏ü‡∏≠‡∏á‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 1 ‡∏ü‡∏≠‡∏á
}


const BUBBLE_LANES = 3; // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏•‡∏ô‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏á (‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 5 ‡πÅ‡∏ñ‡∏ß‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ä‡∏ô‡∏Å‡∏±‡∏ô)
const BUBBLE_SPEED = 115; // px/s ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏ü‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏•‡∏π‡∏Å

/* ---------- ‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ---------- */

const gameArea    = document.getElementById('game');
const bubbleLayer = document.getElementById('bubbleLayer');

const bubbles = [];
let lastSpawnTime = 0;
let lastFrameTime = performance.now();

function createBubble(){
  if(!running || ended) return;

  // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ü‡∏≠‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
  if (bubbles.length >= getMaxBubbles()) return;


  const cfg = LEVELS[currentLevel];
  if (!cfg) return;

  const useCorrect = Math.random() < 0.55; // ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡πÇ‡∏ú‡∏•‡πà‡∏ö‡πà‡∏≠‡∏¢‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á
  const pool = useCorrect ? cfg.correct : cfg.wrong;
  if (!pool.length) return;

  const word = pool[Math.floor(Math.random() * pool.length)];
  const seaEmoji = SEA_EMOJIS[Math.floor(Math.random() * SEA_EMOJIS.length)] || 'üåä';
  const el = document.createElement('div');
  el.className = 'bubble';
  el.innerHTML = `
    <div class="bubble-emoji">${seaEmoji}</div>
    <div class="bubble-text">${word}</div>
  `;
  el.dataset.correct = useCorrect ? '1' : '0';

  // ‡∏ß‡∏≤‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏ô‡∏≠‡∏Å‡∏à‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡∏ô‡∏≤‡∏î
  el.style.transform = 'translate(-9999px, -9999px)';

  bubbleLayer.appendChild(el);

  const r = el.getBoundingClientRect();
  const startX = innerWidth + r.width + 40;

  const minY = innerHeight * 0.18;
  const maxY = innerHeight * 0.8 - r.height;

  // -------- ‡∏£‡∏∞‡∏ö‡∏ö "‡πÄ‡∏•‡∏ô‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á" ‡∏Å‡∏±‡∏ô‡∏ü‡∏≠‡∏á‡∏ä‡∏ô‡∏Å‡∏±‡∏ô --------
  const laneCount = BUBBLE_LANES;
  const laneYs = [];

  if (laneCount <= 1 || maxY <= minY) {
    // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏û‡∏≠/‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ lane ‡πÅ‡∏õ‡∏•‡∏Å ‡πÜ ‚Üí ‡πÉ‡∏ä‡πâ random ‡∏õ‡∏Å‡∏ï‡∏¥
    const yFallback = minY + Math.random() * Math.max(40, maxY - minY);
     const speedFallback = BUBBLE_SPEED; // ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏∏‡∏Å‡∏ü‡∏≠‡∏á
    const bFallback = { el, x:startX, y:yFallback, speed:speedFallback };
    bubbles.push(bFallback);
    el.style.transform = `translate(${startX}px, ${yFallback}px)`;
    el.style.setProperty('--bx', startX + 'px');
    el.style.setProperty('--by', yFallback + 'px');
    el.addEventListener('click', () => handleBubbleHit(bFallback));
    return;
  }

  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á y ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏•‡∏ô (‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á minY‚ÄìmaxY)
  const laneGap = (maxY - minY) / Math.max(laneCount - 1, 1);
  for (let i = 0; i < laneCount; i++) {
    laneYs.push(minY + laneGap * i);
  }

  // ‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏´‡∏ô‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡∏ü‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏•‡∏∏‡∏î‡∏à‡∏≠)
  const occupied = new Set();
  for (const existing of bubbles) {
    if (existing.x < -200) continue; // ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏´‡∏•‡∏∏‡∏î‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏±‡∏ö
    if (typeof existing.lane === 'number') {
      occupied.add(existing.lane);
    }
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á list ‡πÄ‡∏•‡∏ô‡∏ß‡πà‡∏≤‡∏á
  const freeLanes = [];
  for (let i = 0; i < laneCount; i++) {
    if (!occupied.has(i)) freeLanes.push(i);
  }

  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏•‡∏¢ ‚Üí ‡∏¢‡∏≠‡∏°‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏á‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ
  if (!freeLanes.length) {
    el.remove();
    return;
  }

  // ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏•‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á
  const laneIndex = freeLanes[Math.floor(Math.random() * freeLanes.length)];
  const y = laneYs[laneIndex];

   const speed = BUBBLE_SPEED; // px/s ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏ü‡∏≠‡∏á‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÄ‡∏•‡∏ô

  const b = { el, x:startX, y, speed, lane: laneIndex };
  bubbles.push(b);
  el.style.transform = `translate(${startX}px, ${y}px)`;
  el.style.setProperty('--bx', startX + 'px');
  el.style.setProperty('--by', y + 'px');

  el.addEventListener('click', () => handleBubbleHit(b));
}


function moveBubbles(dt){
  if(!running || ended) return;
  const toRemove = [];
  for(const b of bubbles){
    b.x -= b.speed * dt;
    b.el.style.transform = `translate(${b.x}px, ${b.y}px)`;
    b.el.style.setProperty('--bx', b.x + 'px');
    b.el.style.setProperty('--by', b.y + 'px');
    if(b.x < -200){
      toRemove.push(b);
    }
  }
  toRemove.forEach(removeBubble);
}

function removeBubble(b){
  const idx = bubbles.indexOf(b);
  if(idx !== -1) bubbles.splice(idx,1);
  b.el.remove();
}

function handleBubbleHit(b){
  if(!running || ended) return;
  const ok = b.el.dataset.correct === '1';
  score += ok ? 2 : -1;
  answeredCount++;
  emojiHistory.push(ok ? 'üì¶' : 'üò°');
  renderGold(score);
  flyScoreAtCenter(ok, b.el, 0, -20);
  if(ok) playClone(correctSound, VOL.correct);
  else   playClone(wrongSound,   VOL.wrong);
  removeBubble(b);

  if(answeredCount >= MAX_HITS){
    endLevel();
  }
}

/* ---------- ‡∏ï‡∏±‡∏ß‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß + ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß ---------- */
window.__HEAD_TRACK__ = {
  on:false,
  x: innerWidth/2,
  y: innerHeight*0.25
};

const HEAD_RADIUS  = 40;
const HIT_LOCK_MS  = 350;
let lastHitAt      = 0;
let draggingQuestion = false; // ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏≤‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤
let hasManualQuestionPos = false; // ‡∏à‡∏≥‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÅ‡∏•‡πâ‡∏ß
let dragOffsetX = 0;          // ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏Å‡∏±‡∏ö‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏≤‡∏Å
let dragOffsetY = 0;



/* smoothing ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÜ (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏õ‡∏•‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡πÇ‡∏ã‡∏ô 30%) */
let smoothX = innerWidth * 0.175;   // ‡∏Å‡∏•‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á X 5%‚Äì30% ‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ ‚âà 17.5%
let smoothY = innerHeight * 0.5;    // ‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á (‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏î‡∏ô‡∏´‡∏±‡∏Å/‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏∑‡πà‡∏ô ‡πÜ)


/* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÇ‡∏ã‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ß‡∏¥‡πà‡∏á‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà‡πÇ‡∏ã‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ 40% ‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ */
function clampQuestionPosition(){
  const w = window.innerWidth  || document.documentElement.clientWidth  || 0;
  const h = window.innerHeight || document.documentElement.clientHeight || 0;
  if(!w || !h) return;

  // ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 5% ‡∏ñ‡∏∂‡∏á 40% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
  const minX = w * 0.05;   // ‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
  const maxX = w * 0.40;   // ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏ã‡∏ô 40% ‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏à‡∏≠
  if(smoothX < minX) smoothX = minX;
  if(smoothX > maxX) smoothX = maxX;

  // ‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á/‡∏ï‡πà‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏∏‡∏î‡∏Ç‡∏≠‡∏ö)
  const minY = h * 0.10;
  const maxY = h * 0.85;
  if(smoothY < minY) smoothY = minY;
  if(smoothY > maxY) smoothY = maxY;
}

/* ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå */
function placeQuestionFollowHead(){
  const root = document.documentElement;

  // üîπ ‡∏ñ‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏≤‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏°‡∏≤‡∏™‡πå ‚Üí ‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á
  if(draggingQuestion){
    clampQuestionPosition();
    const tx = Math.round(smoothX);
    const ty = Math.round(smoothY);
    root.style.setProperty('--qx', tx + 'px');
    root.style.setProperty('--qy', ty + 'px');
    return;
  }

  const H = window.__HEAD_TRACK__;

  if(!H.on){
    // üîπ ‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á:
    //    - ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏•‡∏≤‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏°‡∏≤‡∏™‡πå ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡πÇ‡∏ã‡∏ô‡∏ã‡πâ‡∏≤‡∏¢
    //    - ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ñ‡∏¢‡∏•‡∏≤‡∏Å‡πÅ‡∏•‡πâ‡∏ß (hasManualQuestionPos=true) ‚Üí ‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÑ‡∏°‡πà‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
    const w = innerWidth  || document.documentElement.clientWidth  || 0;
    const h = innerHeight || document.documentElement.clientHeight || 0;

    if(!hasManualQuestionPos){
      smoothX = w * 0.175;   // ‡∏Å‡∏•‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á 5%‚Äì30%
      smoothY = h * 0.5;
    }
  }else{
    // üîπ ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏µ‡∏Å‡∏•‡πâ‡∏≠‡∏á ‚Üí ‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß
    const alpha = 0.25; // 0‚Äì1 ‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏ï‡∏≤‡∏°‡πÑ‡∏ß
    smoothX = smoothX + alpha*(H.x - smoothX);
    smoothY = smoothY + alpha*(H.y - smoothY);

    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏°‡∏≤‡∏™‡πå"
    hasManualQuestionPos = false;
  }

  // ‡∏ö‡∏µ‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ 40%
  clampQuestionPosition();

  const tx = Math.round(smoothX);
  const ty = Math.round(Math.max(20, smoothY));
  root.style.setProperty('--qx', tx + 'px');
  root.style.setProperty('--qy', ty + 'px');
}


/* ---------- ‡∏•‡∏≤‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏°‡∏≤‡∏™‡πå (‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á) ---------- */
function getMousePos(evt){
  // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á mouse ‡πÅ‡∏•‡∏∞ touch
  if (evt.touches && evt.touches.length) {
    const t = evt.touches[0];
    return { x: t.clientX, y: t.clientY };
  }
  if (evt.changedTouches && evt.changedTouches.length) {
    const t = evt.changedTouches[0];
    return { x: t.clientX, y: t.clientY };
  }
  return { x: evt.clientX, y: evt.clientY };
}


function onQuestionMouseDown(e){
  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏•‡πâ‡∏≠‡∏á AR ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà (‡∏°‡∏µ‡∏´‡∏±‡∏ß) ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡∏µ‡∏Å‡∏±‡∏ô
  if(window.__HEAD_TRACK__?.on) return;
  if(!running || ended) return;
  e.preventDefault();

  if(!qBox) return;
  const rect = qBox.getBoundingClientRect();
  if(!rect.width || !rect.height) return;

  const pos = getMousePos(e);

  // ‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô)
  const centerX = rect.left + rect.width  / 2;
  const centerY = rect.top  + rect.height / 2;

  // ‡πÄ‡∏Å‡πá‡∏ö offset ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏Å‡∏±‡∏ö‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á
  dragOffsetX = centerX - pos.x;
  dragOffsetY = centerY - pos.y;

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏≤‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á (‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πâ‡∏á)
  smoothX = centerX;
  smoothY = centerY;

  hasManualQuestionPos = true;   // ‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏ò‡∏á‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÅ‡∏•‡πâ‡∏ß
  draggingQuestion = true;
}

function onQuestionMouseMove(e){
  if(!draggingQuestion) return;
  e.preventDefault();  // ‚¨Ö ‡∏Å‡∏±‡∏ô‡∏à‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏™‡πÑ‡∏•‡∏î‡πå‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏ô‡∏¥‡πâ‡∏ß‡∏•‡∏≤‡∏Å

  const pos = getMousePos(e);

  // ‡∏Ç‡∏¢‡∏±‡∏ö "‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á" ‡∏ï‡∏≤‡∏°‡πÄ‡∏°‡∏≤‡∏™‡πå + offset ‡πÄ‡∏î‡∏¥‡∏°
  smoothX = pos.x + dragOffsetX;
  smoothY = pos.y + dragOffsetY;

  // ‡∏ö‡∏µ‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏∏‡∏î‡πÇ‡∏ã‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ 40%
  clampQuestionPosition();
}



function onQuestionMouseUp(){
  draggingQuestion = false;
}

// ‡∏ú‡∏π‡∏Å event ‡∏Å‡∏±‡∏ö "‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤" ‡πÅ‡∏ó‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
if(qSprite){
  qSprite.style.pointerEvents = 'auto';
  qSprite.addEventListener('mousedown', onQuestionMouseDown);
  qSprite.addEventListener('touchstart', onQuestionMouseDown, { passive:false }); // ‚úÖ ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡πÑ‡∏≠‡πÅ‡∏û‡∏î
}

if(qBox){
  // ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏ö‡∏™‡∏ô
  qBox.style.pointerEvents = 'none';
}
window.addEventListener('mousemove', onQuestionMouseMove);
window.addEventListener('mouseup', onQuestionMouseUp);
window.addEventListener('touchmove', onQuestionMouseMove, { passive:false }); // ‚úÖ ‡∏•‡∏≤‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏¥‡πâ‡∏ß
window.addEventListener('touchend', onQuestionMouseUp);        // ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ô‡∏¥‡πâ‡∏ß = ‡∏´‡∏¢‡∏∏‡∏î‡∏•‡∏≤‡∏Å
window.addEventListener('touchcancel', onQuestionMouseUp);     // touch ‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å



/* ‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏ô‡∏´‡∏±‡∏ß‡∏Å‡∏±‡∏ö‡∏ü‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏® */
function headBubbleCollideCheck(now){
  if(!running || ended || paused) return;

  const H = window.__HEAD_TRACK__;
  const circleIntersectsRect = (cx,cy,rr,rc)=>{
    const nx = Math.max(rc.left, Math.min(cx, rc.right));
    const ny = Math.max(rc.top,  Math.min(cy, rc.bottom));
    const dx=cx-nx, dy=cy-ny;
    return (dx*dx + dy*dy) <= rr*rr;
  };

  // üîπ ‡∏Å‡∏£‡∏ì‡∏µ "‡∏°‡∏µ‡∏´‡∏±‡∏ß‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á" ‚Üí ‡πÉ‡∏ä‡πâ‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤ + ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏õ‡πá‡∏ô hit box
  if(H.on){
    if(now - lastHitAt < HIT_LOCK_MS) return;
    if(!qSprite) return;

    const sRect = qSprite.getBoundingClientRect();
    if(!sRect.width || !sRect.height) return;

    const cx = (sRect.left + sRect.right) / 2;
    const cy = (sRect.top  + sRect.bottom) / 2;
    // ‚úÖ ‡∏£‡∏±‡∏®‡∏°‡∏µ hit box ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏•‡∏≤‡πÄ‡∏¢‡∏≠‡∏∞ (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡πÉ‡∏à)
    const R  = Math.min(sRect.width, sRect.height) * 0.18;

    for(const b of bubbles){
      const bRect = b.el.getBoundingClientRect();
      if(circleIntersectsRect(cx, cy, R, bRect)){
        lastHitAt = now;
        handleBubbleHit(b);
        break;
      }
    }
    return;
  }

  // üîπ ‡∏Å‡∏£‡∏ì‡∏µ "‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á" ‚Üí ‡πÉ‡∏ä‡πâ‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° + ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏õ‡πá‡∏ô hit box
  if(now - lastHitAt < HIT_LOCK_MS) return;
  if(!qBox) return;

  const qRect = qBox.getBoundingClientRect();
  if(!qRect.width || !qRect.height) return;

  const qx = (qRect.left + qRect.right) / 2;
  const qy = (qRect.top  + qRect.bottom) / 2;
  // ‚úÖ ‡∏£‡∏±‡∏®‡∏°‡∏µ hit box ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏•‡πà‡∏≠‡∏á)
  const qR = Math.min(qRect.width, qRect.height) * 0.4;

  for(const b of bubbles){
    const bRect = b.el.getBoundingClientRect();
    if(circleIntersectsRect(qx, qy, qR, bRect)){
      lastHitAt = now;
      handleBubbleHit(b);
      break;
    }
  }
}

/* ---------- ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß/‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ 40% (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏•‡∏≤) ---------- */
// üîπ ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ô‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≠‡∏ô‡∏´‡∏±‡∏ß‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô (ms)
let zoneOutStart = null;

function checkHeadZoneAlert(){
  if(!zoneAlert) return;

  const H = window.__HEAD_TRACK__;
  const now = performance.now();

  // ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á in-game ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
  if(!H?.on || !running || ended){
    zoneOutStart = null;
    zoneAlert.style.opacity = '0';
    zoneAlert.style.pointerEvents = 'none';
    return;
  }

  const w = window.innerWidth  || document.documentElement.clientWidth  || 0;
  const h = window.innerHeight || document.documentElement.clientHeight || 0;
  if(!w || !h){
    zoneOutStart = null;
    zoneAlert.style.opacity = '0';
    zoneAlert.style.pointerEvents = 'none';
    return;
  }

  // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î "‡πÇ‡∏ã‡∏ô‡∏õ‡∏•‡∏≤" ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö clampQuestionPosition()
  const zoneMinX = w * 0.05;  // 5% (‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)
  const zoneMaxX = w * 0.30;  // 30% (‡∏à‡∏ö‡πÇ‡∏ã‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ 40% ‡∏ó‡∏µ‡πà‡πÄ‡∏ú‡∏∑‡πà‡∏≠ margin)

  const inZone = (H.x >= zoneMinX && H.x <= zoneMaxX);

  if(inZone){
    // ‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏ã‡∏ô ‚Üí ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏±‡∏ß‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ + ‡∏ã‡πà‡∏≠‡∏ô alert
    zoneOutStart = null;
    zoneAlert.style.opacity = '0';
    zoneAlert.style.pointerEvents = 'none';
  }else{
    // ‡∏´‡∏±‡∏ß‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô
    if(zoneOutStart === null){
      // ‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô ‚Üí ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤
      zoneOutStart = now;
    }

    const elapsed = now - zoneOutStart;

    if(elapsed >= 3000){
      // ‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô‡∏Ñ‡∏£‡∏ö 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‚Üí ‡πÅ‡∏™‡∏î‡∏á alert ‡∏ó‡∏µ‡πà‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÇ‡∏ã‡∏ô 40%
      const centerX = (zoneMinX + zoneMaxX) / 2;
      const centerY = h * 0.5;

      zoneAlert.style.left = centerX + 'px';
      zoneAlert.style.top  = centerY + 'px';
      zoneAlert.style.opacity = '1';
      zoneAlert.style.pointerEvents = 'none';
    }else{
      // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‚Üí ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏ä‡∏ß‡πå
      zoneAlert.style.opacity = '0';
      zoneAlert.style.pointerEvents = 'none';
    }
  }
}




/* ---------- main game loop ---------- */
function rafLoop(now){
  const dt = (now - lastFrameTime)/1000;
  lastFrameTime = now;

  if(!ended && !paused){
    placeQuestionFollowHead();
    moveBubbles(dt);

    // ‡∏™‡∏∏‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á: ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏∏‡∏Å ‡πÜ 1.6‚Äì2.6 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    const gap = 2000 + Math.random()*1000;
    if(now - lastSpawnTime > gap){
      createBubble();
      lastSpawnTime = now;
    }

    headBubbleCollideCheck(now);
    checkHeadZoneAlert();    // üîî ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô‡∏õ‡∏•‡∏≤
  }
  requestAnimationFrame(rafLoop);
}
requestAnimationFrame(rafLoop);

/* ---------- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°/‡∏à‡∏ö‡πÄ‡∏Å‡∏° ---------- */
function getBadgeEmoji(sc){
  if(sc <= 5)  return '‚ù§Ô∏è';
  if(sc <= 10) return 'ü•á';
  if(sc <= 15) return 'üèÜ';
  return 'üèÜ';
}

function resetState(keepLevel=true){
  stopTimer();                    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï/‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏±‡∏ß‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡πà‡∏≠‡∏ô
  timeLeftSec = TOTAL_TIME_SEC;   // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà 2 ‡∏ô‡∏≤‡∏ó‡∏µ
  updateClock();                  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô)

  running=false; ended=true; paused=false;
  score=0; answeredCount=0;
  emojiHistory=[];
  renderGold(0);


  // ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
  while(bubbles.length){
    removeBubble(bubbles[0]);
  }

  // ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°/‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥ (‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≠‡∏ô setQuestionForLevel ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
  qBox.textContent = '';
  if(qBoxTop) qBoxTop.textContent = '';
  if(qEmoji) qEmoji.textContent = '';
  // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏ö src ‡∏Ç‡∏≠‡∏á qSprite

  // üîπ ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ display ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á/‡∏õ‡∏•‡∏≤ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏°‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
  if (qBoxTop) {
    qBoxTop.style.display = '';
  }
  if (qBox) {
    qBox.style.display = '';
  }
  if (qSprite) {
    qSprite.style.display = '';
  }

  // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ level ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏ß‡πâ
  if(!keepLevel) currentLevel = 1;
}


function setQuestionForLevel(){
  const cfg = LEVELS[currentLevel] || LEVELS[1];

  // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å (‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô aria + hitbox, ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô)
  qBox.textContent = cfg.question;

  // ‡∏™‡∏∏‡πà‡∏°‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á (‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
  const palettes = [
    ['#ff8a00','#e52e71'],
    ['#00dbde','#fc00ff'],
    ['#00c6ff','#0072ff'],
    ['#f9d423','#ff4e50'],
    ['#4facfe','#00f2fe'],
    ['#f77062','#fe5196'],
    ['#43e97b','#38f9d7'],
    ['#fa709a','#fee140']
  ];
  const p = palettes[(Math.random()*palettes.length)|0];
  const grad = `linear-gradient(135deg, ${p[0]}, ${p[1]})`;

  // ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° + ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏ß‡∏¢ ‡πÜ
  if(qBoxTop){
    qBoxTop.textContent = cfg.question;
    qBoxTop.style.setProperty('--qbox-bg', grad);
  }

  // ‡∏™‡∏∏‡πà‡∏°‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤ 1‚Äì5 ‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå image
  if(qSprite){
    const idx = 1 + Math.floor(Math.random() * 5);  // 1..5
    qSprite.src = `image/fish${idx}.png`;
  }

  // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡πÅ‡∏•‡πâ‡∏ß (‡∏ã‡πà‡∏≠‡∏ô qEmoji ‡∏î‡πâ‡∏ß‡∏¢ CSS)
  playClone(questionSound, VOL.question);
}

function startGame(){
  // üîπ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡∏à‡∏£‡∏¥‡∏á ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ prestart + countdown ‡πÄ‡∏Å‡πà‡∏≤
  document.body.classList.remove('prestart');
  clearStartCountdown();

  document.body.classList.add('in-game');
  overlay.style.visibility='hidden';
  overlay.style.opacity='0';

  resetState(true);
  ended=false; running=true; paused=false;
  lastSpawnTime = performance.now();

  setQuestionForLevel();
  startTimer();   // ‚è∞ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πà‡∏≤‡∏ô

  bgm?.play?.().catch(()=>{});
}


function endLevel(){
  if(ended) return;
  ended = true;
  running = false;
  stopTimer();   // ‚èπ ‡∏´‡∏¢‡∏∏‡∏î‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô

  // üîπ ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ü‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏à‡∏≠
  while (bubbles.length) {
    removeBubble(bubbles[0]);
  }

  // üîπ ‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ö‡∏ô / hitbox ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á / ‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤
  if (qBoxTop) {
    qBoxTop.textContent = '';
    qBoxTop.style.display = 'none';
  }
  if (qBox) {
    qBox.textContent = '';
    qBox.style.display = 'none';
  }
  if (qSprite) {
    qSprite.style.display = 'none';
  }

  // üîπ ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÇ‡∏ã‡∏ô‡∏´‡∏±‡∏ß (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏¢‡∏π‡πà)
  if (zoneAlert) {
    zoneAlert.style.opacity = '0';
  }

  // üîπ ‡∏ñ‡∏≠‡∏î in-game ‚Üí HUD / ‡∏£‡∏π‡∏õ‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö / ‡∏õ‡∏•‡∏≤ ‡∏Ø‡∏•‡∏Ø ‡∏´‡∏≤‡∏¢ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ overlay
  document.body.classList.remove('in-game');

  // ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô + ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏ö‡πÄ‡∏Å‡∏°
  finalScoreEl.textContent = String(score);
  document.getElementById('scoreBadge').textContent = getBadgeEmoji(score);
  overlay.style.visibility = 'visible';
  overlay.style.opacity = '1';
  bgm?.pause?.();
  playClone(winSound, VOL.win);
}



/* ---------- ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° ---------- */
pauseBtn.addEventListener('click', ()=>{
  if(!running || ended) return;
  paused = !paused;
  pauseBtn.textContent = paused ? '‚ñ∂Ô∏è ‡∏ï‡πà‡∏≠' : '‚è∏ ‡∏´‡∏¢‡∏∏‡∏î';
});

restartBtn.addEventListener('click', ()=>{
  overlay.style.visibility='hidden';
  overlay.style.opacity='0';
  startGame();
});

selectLevelBtn.addEventListener('click', ()=>{
  clearStartCountdown();                         // ‚úÖ ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πà‡∏≤
  overlay.style.visibility='hidden';
  overlay.style.opacity='0';
  resetState(true);
  document.body.classList.remove('in-game');
  document.body.classList.remove('prestart');    // ‚úÖ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏´‡∏°‡∏î prestart ‡∏î‡πâ‡∏ß‡∏¢
  document.getElementById('startScreen').style.display='none';
  document.getElementById('landing').classList.remove('hide');
  try{ bgm.currentTime = 0; bgm.play()?.catch(()=>{}); }catch(_){}
});

quickRestart.addEventListener('click', ()=>{
  clearStartCountdown();                         // ‚úÖ ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πà‡∏≤
  resetState(true);
  document.body.classList.remove('in-game');
  document.body.classList.remove('prestart');    // ‚úÖ ‡∏Å‡∏±‡∏ô HUD ‡∏ï‡∏¥‡∏î‡∏Ñ‡πâ‡∏≤‡∏á
  document.getElementById('startScreen').style.display='none';
  document.getElementById('landing').classList.remove('hide');
  try{ bgm.currentTime = 0; bgm.play()?.catch(()=>{}); }catch(_){}
});


/* ----- Welcome ‚Üí Landing ----- */
(function(){
  const welcome = document.getElementById('welcome');
  const enterBtn = document.getElementById('enterBtn');
  const landing  = document.getElementById('landing');
  enterBtn.addEventListener('click', ()=>{
    welcome.classList.add('hide');
    landing.classList.remove('hide');
    bgm?.play?.().catch(()=>{});
  });
})();

/* ----- ‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô + ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏° ----- */
(function(){
  const landing     = document.getElementById('landing');
  const startScreen = document.getElementById('startScreen');
  const startBtn    = document.getElementById('startBtn');
  const countdownEl = document.getElementById('countdown');
  const startTitle  = document.getElementById('startTitle');

  function getMissionTitle(lv){
    const cfg = LEVELS[lv] || LEVELS[1];
    return cfg.title;
  }

  document.querySelectorAll('.levelBtn').forEach(btn=>{
    if(btn.id === 'guideBtn') return;
    btn.addEventListener('click', ()=>{
      clearStartCountdown();   // ‚úÖ ‡∏Å‡∏±‡∏ô‡πÄ‡∏Ñ‡∏™‡∏Å‡∏î‡∏î‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏≠‡∏ô countdown ‡∏î‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà

      currentLevel = Number(btn.dataset.level || 1);
      startTitle.textContent = getMissionTitle(currentLevel);

      document.body.classList.add('prestart');
      landing.classList.add('hide');
      startScreen.style.display = 'flex';

      if(startBtn){
        startBtn.style.display='inline-block';
        startBtn.disabled=false;
        startBtn.style.pointerEvents='auto';
      }
      if(countdownEl){
        countdownEl.style.display='none';
        countdownEl.textContent='3';
      }
    });
  });


  startBtn?.addEventListener('click', ()=>{
    // üîπ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ countdown ‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ó‡∏¥‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô
    clearStartCountdown();

    startBtn.disabled = true;
    startBtn.style.pointerEvents='none';
    startBtn.style.display='none';

    let n = 3;
    countdownEl.textContent = n;
    countdownEl.style.display = 'block';

    // ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏Å‡∏•‡∏≤‡∏á startCountdownTimer
    startCountdownTimer = setInterval(()=>{
      n--;
      if(n>0){
        countdownEl.textContent = n;
      }else{
        clearInterval(startCountdownTimer);
        startCountdownTimer = null;

        countdownEl.style.display='none';
        startScreen.style.display='none';

        // ‡∏Å‡∏±‡∏ô‡πÄ‡∏Ñ‡∏™‡∏´‡∏•‡∏∏‡∏î‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà prestart ‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÑ‡∏°‡πà startGame)
        if(document.body.classList.contains('prestart')){
          startGame();
        }

        startBtn.disabled=false;
        startBtn.style.pointerEvents='auto';
      }
    },1000);
  });


  document.getElementById('guideBtn')?.addEventListener('click', ()=>{
    landing.classList.add('hide');
    document.getElementById('guideScreen').style.display='flex';
  });
  document.getElementById('guideBack')?.addEventListener('click', ()=>{
    document.getElementById('guideScreen').style.display='none';
    landing.classList.remove('hide');
  });
})();

/* ---------- ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏π‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á (‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏ü‡∏≠‡∏á) ---------- */
(function(){
  const micBtn = document.getElementById('micBtn');
  if(!micBtn) return;
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!SR){
    micBtn.textContent='üé§ ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö';
    micBtn.disabled=true;
    return;
  }
  const rec = new SR();
  rec.lang='th-TH';
  rec.continuous=true;
  rec.interimResults=true;

  function tokensFrom(s){
    s = (s||'').toLowerCase().trim();
    s = s.replace(/\s*(‡∏Ñ‡πà‡∏∞|‡∏Ñ‡∏£‡∏±‡∏ö|‡∏Ñ‡∏∞|‡∏Æ‡∏∞)$/,'');
    return s.split(/[\s,Ôºå„ÄÇ\.!?:;„ÄÅ]+/).filter(Boolean);
  }
  function currentOptionsMap(){
    const map = new Map();
    document.querySelectorAll('.bubble').forEach(n=>{
      const t = (n.textContent||'').trim().toLowerCase();
      if(!t) return;
      if(!map.has(t)) map.set(t,[]);
      map.get(t).push(n);
    });
    return map;
  }
  function pickNearest(arr){ return arr[0]; }
  function tryFire(phrase){
    const toks = tokensFrom(phrase);
    if(!toks.length) return false;
    const cmap = currentOptionsMap();
    for(const t of toks){
      if(cmap.has(t)){
        const node = pickNearest(cmap.get(t));
        node?.click();
        return true;
      }
    }
    return false;
  }
  rec.onresult = (e)=>{
    for(let i=e.resultIndex; i<e.results.length; i++){
      const r = e.results[i];
      const txt = (r[0]?.transcript||'').trim();
      if(!txt) continue;
      tryFire(txt);
    }
  };
})();
})(); // end IIFE
</script>

<!-- ===== Pose (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡∏´‡∏±‡∏ß‡∏à‡∏∞‡πÑ‡∏õ‡∏Ç‡∏¢‡∏±‡∏ö __HEAD_TRACK__ ) ===== -->
<script type="module">
import {PoseLandmarker, FilesetResolver} from "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3";
const camBtn = document.getElementById('camBtn');
const video  = document.getElementById('cameraMirror');
const cvs    = document.getElementById('camCanvas');
const cameraBg = document.getElementById('cameraBg');
const ctx    = cvs.getContext('2d', { alpha: true });

const DETECT_W = 320;
let detectCanvas = document.createElement('canvas');
let detectCtx = detectCanvas.getContext('2d', { alpha:false, desynchronized:true });

let CAM_ON=false, landmarker=null, raf=0, stream=null;

function fitCanvas(){
  const dpr = CAM_ON? 1 : Math.max(1, window.devicePixelRatio||1);
  cvs.width=Math.round(innerWidth*dpr);
  cvs.height=Math.round(innerHeight*dpr);
  cvs.style.width=innerWidth+'px';
  cvs.style.height=innerHeight+'px';
  ctx.setTransform(1,0,0,1,0,0);
  ctx.scale(dpr,dpr);
}
fitCanvas();
addEventListener('resize', fitCanvas);

function coverCropRect(){
  const vw=video.videoWidth||640, vh=video.videoHeight||480;
  const sw=innerWidth, sh=innerHeight;
  const scale=Math.max(sw/vw, sh/vh);
  const sW=Math.round(sw/scale), sH=Math.round(sh/scale);
  const sX=Math.round((vw-sW)/2), sY=Math.round((vh-sH)/2);
  return {sX,sY,sW,sH,vw,vh,sw,sh};
}
function mapToScreen(nx,ny){
  const {sX,sY,sW,sH,vw,vh,sw,sh} = coverCropRect();
  const px=nx*vw, py=ny*vh;
  const u=(px-sX)/sW, v=(py-sY)/sH;
  let x=u*sw, y=v*sh;
  x=sw-x; // mirror
  return {x,y};
}

async function ensureLandmarker(){
  if(landmarker) return landmarker;
  const fileset = await FilesetResolver.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/wasm");
  landmarker = await PoseLandmarker.createFromOptions(fileset, {
    baseOptions:{ modelAssetPath:"https://storage.googleapis.com/mediapipe-models/pose_landmarker/pose_landmarker_lite/float16/1/pose_landmarker_lite.task" },
    runningMode:'VIDEO',
    numPoses:1,
    minPoseDetectionConfidence: .50,
    minPosePresenceConfidence : .60,
    minTrackingConfidence     : .70
  });
  return landmarker;
}

const SHOW_DEBUG=false;
const EYE_OFFSET_PX = 0; // ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏•‡∏ö‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏î‡πÄ‡∏ä‡∏¢
function drawPoseAndHead(res){
  const sw=innerWidth, sh=innerHeight;
  ctx.clearRect(0,0,sw,sh);

  if(!res?.landmarks?.length){
    window.__HEAD_TRACK__.on = false;
    return;
  }

  const lm = res.landmarks[0];

  // üîπ ‡πÉ‡∏ä‡πâ‡∏à‡∏°‡∏π‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á (MediaPipe Pose: index 1 = nose)
  const nose = lm[1];
  if(!nose){
    window.__HEAD_TRACK__.on = false;
    return;
  }

  // ‡πÅ‡∏õ‡∏•‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏°‡∏π‡∏Å‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏Å‡∏•‡πâ‡∏≠‡∏á ‚Üí ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏≠
  const base = mapToScreen(nose.x, nose.y);

  // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏õ‡∏•‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á ‚Äú‡∏ö‡∏ô‡∏à‡∏°‡∏π‡∏Å‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢‚Äù ‡∏Ñ‡πà‡∏≠‡∏¢‡∏õ‡∏£‡∏±‡∏ö offset ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ
  const head = { x: base.x, y: base.y - EYE_OFFSET_PX };

  window.__HEAD_TRACK__.on = true;
  window.__HEAD_TRACK__.x = head.x;
  window.__HEAD_TRACK__.y = head.y;

  if(SHOW_DEBUG){
    ctx.beginPath();
    ctx.arc(head.x, head.y, 28, 0, Math.PI*2);
    ctx.lineWidth=3;
    ctx.strokeStyle='#fff';
    ctx.stroke();
  }
}

function runLoop(){
  const step=()=>{
    if(!video.videoWidth){ raf=requestAnimationFrame(step); return; }
    const now=performance.now();
    try{
      const {sX,sY,sW,sH}=coverCropRect();
      detectCtx.drawImage(video, sX,sY,sW,sH, 0,0, detectCanvas.width, detectCanvas.height);
      const res=landmarker.detectForVideo(detectCanvas, now);
      drawPoseAndHead(res);
    }catch(e){}
    raf=requestAnimationFrame(step);
  };
  raf=requestAnimationFrame(step);
}

async function startCamera(){
  await ensureLandmarker();
  stream = await navigator.mediaDevices.getUserMedia({
    video: { width: 960, height: 540, frameRate: 30, facingMode: 'user' },
    audio: false
  });
  video.srcObject=stream;
  await video.play().catch(()=>{});
  const vw=video.videoWidth||640, vh=video.videoHeight||480;
  const ratio=vw/vh;
  detectCanvas.width=DETECT_W;
  detectCanvas.height=Math.round(DETECT_W/ratio);

  video.style.display='block';
  cvs.style.display='block';
  if (cameraBg) cameraBg.style.display = 'block';
  camBtn.textContent='üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î';
  CAM_ON=true;

  fitCanvas();
  runLoop();
}
function stopCamera(){
  cancelAnimationFrame(raf);
  if(stream){ stream.getTracks().forEach(t=>t.stop()); stream=null; }
  try{ video.pause(); }catch(e){}
  video.removeAttribute('srcObject');

  video.style.display='none';
  cvs.style.display='none';
  if (cameraBg) cameraBg.style.display = 'none';
  ctx.clearRect(0,0,innerWidth,innerHeight);
  camBtn.textContent='üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á: ‡∏õ‡∏¥‡∏î';
  CAM_ON=false;
  fitCanvas();
  window.__HEAD_TRACK__.on=false;
}

camBtn.addEventListener('click', async ()=>{
  if(!stream){
    try{ await startCamera(); }
    catch(err){
      camBtn.textContent='üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á: ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï';
      camBtn.disabled=true;
    }
  }else{
    stopCamera();
  }
});
document.addEventListener('visibilitychange', ()=>{
  if(document.hidden && stream) stopCamera();
});
</script>

<!-- ===== Preload Overlay (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ===== -->
<div id="preloadOverlay" style="
  position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
  background:#000c; color:#fff; z-index:99999; flex-direction:column; gap:12px;
  font-weight:900; text-align:center;">
  <div id="preloadText" style="font-size:20px">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå‚Ä¶ 0%</div>
  <div style="width:min(80vw,480px); height:10px; background:#ffffff22; border-radius:999px; overflow:hidden">
    <div id="preloadBar" style="height:100%; width:0%; background:#10b981; transition:width .2s ease"></div>
  </div>
  <div id="preloadSub" style="font-size:12px;opacity:.85">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</div>
</div>

<script>
(()=> {
  const overlay = document.getElementById('preloadOverlay');
  const textEl  = document.getElementById('preloadText');
  const barEl   = document.getElementById('preloadBar');
  const subEl   = document.getElementById('preloadSub');

  const enterBtn   = document.getElementById('enterBtn');
  const levelBtns  = Array.from(document.querySelectorAll('.levelBtn'));
  function lockUI(lock=true){
    if(enterBtn){
      enterBtn.disabled = lock;
      enterBtn.style.pointerEvents = lock ? 'none' : 'auto';
      enterBtn.style.opacity = lock ? '.5' : '1';
      enterBtn.textContent = lock ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‚Ä¶' : '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏°';
    }
    levelBtns.forEach(b=>{
      b.disabled = lock;
      b.style.pointerEvents = lock ? 'none' : 'auto';
      b.style.opacity = lock ? '.6' : '1';
    });
  }
  lockUI(true);

  const IMAGES = [
    "image/background2.png",
    "image/welcome.png",
    "image/banner2.png",
    "image/guide.png",
    "image/button1.png",
    "image/button2.png",
    "image/plus1.png",
    "image/plus2.png",
    "image/ans.png",
    "image/camerabackground.png"
  ];
  for(let i=1;i<=8;i++){
    IMAGES.push(`image/house${i}.png`);
  }
  // ‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤ 5 ‡∏£‡∏π‡∏õ
  for(let i=1;i<=5;i++){
    IMAGES.push(`image/fish${i}.png`);
  }

  const AUDIOS = [
    "image/audio1.mp3",
    "image/win2.mp3",
    "image/bgm3.mp3",
    "image/question.mp3",
    "image/audio.mp3",
    "image/wrong.mp3"
  ];
  const FONTS = [
    "400 24px MyGameFont",
    "700 24px MyGameFont"
  ];

  const tasks = [];

  IMAGES.forEach(src=>{
    tasks.push(()=>new Promise(res=>{
      const img = new Image();
      img.onload = ()=>res({ok:true, src});
      img.onerror= ()=>res({ok:false, src});
      img.src = src;
    }));
  });
  AUDIOS.forEach(src=>{
    tasks.push(()=>new Promise(res=>{
      const a = new Audio();
      a.preload="auto";
      const done = ok=>{
        a.removeEventListener('canplaythrough', onReady);
        a.removeEventListener('loadeddata', onReady);
        a.removeEventListener('error', onErr);
        res({ok, src});
      };
      const onReady = ()=>done(true);
      const onErr   = ()=>done(false);
      a.addEventListener('canplaythrough', onReady, {once:true});
      a.addEventListener('loadeddata', onReady, {once:true});
      a.addEventListener('error', onErr, {once:true});
      const t = setTimeout(()=>done(false), 6000);
      a.addEventListener('canplaythrough', ()=>clearTimeout(t), {once:true});
      a.addEventListener('loadeddata', ()=>clearTimeout(t), {once:true});
      a.addEventListener('error', ()=>clearTimeout(t), {once:true});
      a.src = src;
      a.load();
    }));
  });
  if(document.fonts && document.fonts.load){
    FONTS.forEach(f=>{
      tasks.push(()=>document.fonts.load(f).then(()=>({ok:true, src:f})).catch(()=>({ok:false, src:f})));
    });
  }

  const TOTAL = tasks.length;
  let doneCount = 0;

  function renderProgress(currentSrc){
    const pct = Math.round((doneCount / TOTAL) * 100);
    if(textEl) textEl.textContent = `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå‚Ä¶ ${pct}%`;
    if(barEl) barEl.style.width = pct + "%";
    if(subEl && currentSrc) subEl.textContent = `‡πÇ‡∏´‡∏•‡∏î: ${currentSrc}`;
  }

  async function runPreload(){
    for(const job of tasks){
      const r = await job();
      doneCount++;
      renderProgress(r?.src);
    }
    renderProgress("‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô");
    lockUI(false);
    if(overlay){
      overlay.style.transition = "opacity .35s ease";
      overlay.style.opacity = "0";
      setTimeout(()=>overlay.remove(), 380);
    }
  }

  renderProgress();
  runPreload();
})();
</script>
</body>
</html>



